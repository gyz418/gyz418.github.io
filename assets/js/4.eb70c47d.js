(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{350:function(t,s,a){t.exports=a.p+"assets/img/1.9f3440ae.png"},351:function(t,s,a){t.exports=a.p+"assets/img/2.8e16f298.png"},352:function(t,s,a){t.exports=a.p+"assets/img/6.a44d97c6.jpg"},353:function(t,s,a){t.exports=a.p+"assets/img/7.0454bc62.jpg"},354:function(t,s,a){t.exports=a.p+"assets/img/8.d1364ae7.jpg"},380:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"js概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#js概念"}},[t._v("#")]),t._v(" js概念")]),t._v(" "),n("h3",{attrs:{id:"js单线程。"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#js单线程。"}},[t._v("#")]),t._v(" JS单线程。")]),t._v(" "),n("ol",[n("li",[t._v("JS同时只能执行一个JS任务。JS主要用于用户交互和操作DOM，如果多线程的话，一个线性在DOM上添加内容，一个线性删除内容，会麻烦")]),t._v(" "),n("li",[t._v("浏览器或node环境是多线性，辅助js线程")]),t._v(" "),n("li",[t._v("js引擎线程（主线程）运行js代码，遇到 setTimeout就把它交给浏览器的 定时器触发线程处理， ajax交给http异步线程处理， dom.onclick(fn()) 交给浏览器事件线程去执行")]),t._v(" "),n("li",[t._v("主线程执行同步代码，遇到异步代码就交给浏览器异步线程，浏览器异步线程执行异步代码成功后，把回调函数丢进队列。 主线程执行完代码就去队列看一下，有没有回调函数要执行")]),t._v(" "),n("li",[t._v("主线程、异步线程、消息队列，三者通过EventLoop事件循环来沟通")])]),t._v(" "),n("h3",{attrs:{id:"网络通信，数据加密"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络通信，数据加密"}},[t._v("#")]),t._v(" 网络通信，数据加密")]),t._v(" "),n("p",[t._v("对称加密（速度快）： 数据加密和解密用同一个密钥。双方一起保管。密钥传输麻烦")]),t._v(" "),n("p",[t._v("非对称加密RSA:")]),t._v(" "),n("ol",[n("li",[t._v("双方有一对钥匙，一个私钥（保密的），一个公钥（公开的）。")]),t._v(" "),n("li",[t._v("用私钥加密的数据，只有对应的公钥才能解密。")]),t._v(" "),n("li",[t._v("用公钥加密的数据，只有对应的私钥才能解密。")]),t._v(" "),n("li",[t._v("A给B发消息时，用B的公钥加密，B收到后，用B的私钥解密。")]),t._v(" "),n("li",[t._v("把公钥和信息通过hash算法生成消息摘要，用CA(认证)私钥加密，生成数字签名，再把公钥和信息、数字签名合并成数字证书。")]),t._v(" "),n("li",[t._v("CA证书会有操作系统/浏览器预置顶级CA证书来保证没被篡改")])]),t._v(" "),n("h3",{attrs:{id:"https-就是用了ca证书"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#https-就是用了ca证书"}},[t._v("#")]),t._v(" https 就是用了CA证书")]),t._v(" "),n("ol",[n("li",[t._v("客户端发出请求")]),t._v(" "),n("li",[t._v("服务器发送数字证书（公钥）给客户端")]),t._v(" "),n("li",[t._v("浏览器用公钥加密请求数据")]),t._v(" "),n("li",[t._v("服务器用私钥解密响应数据")])]),t._v(" "),n("h3",{attrs:{id:"cpu缓存：-cpu速度比内存快，内存比硬盘快"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cpu缓存：-cpu速度比内存快，内存比硬盘快"}},[t._v("#")]),t._v(" CPU缓存： CPU速度比内存快，内存比硬盘快")]),t._v(" "),n("h3",{attrs:{id:"二进制："}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二进制："}},[t._v("#")]),t._v(" 二进制：")]),t._v(" "),n("ol",[n("li",[t._v("计算机是没有减法的，当计算 1-1时，会转换成1+（-1），")]),t._v(" "),n("li",[t._v("-1 ：1的值为 0000 0001， 再取反为  1111 1110 再加1，最终值为 1111 1111")]),t._v(" "),n("li",[t._v("最后相加高位1溢出，直接忽略\n"),n("img",{attrs:{src:a(350),alt:"1-1=0"}})])]),t._v(" "),n("h3",{attrs:{id:"磁盘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#磁盘"}},[t._v("#")]),t._v(" 磁盘")]),t._v(" "),n("p",[t._v("磁道是指同心圆区域")]),t._v(" "),n("p",[n("img",{attrs:{src:a(351),alt:"磁盘"}})]),t._v(" "),n("h2",{attrs:{id:"国家"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#国家"}},[t._v("#")]),t._v(" 国家")]),t._v(" "),n("blockquote",[n("p",[t._v("印度")])]),t._v(" "),n("p",[t._v("印度分离出了巴基斯坦，种族歧视，等级歧视，性别歧视。女性地位低")]),t._v(" "),n("blockquote",[n("p",[t._v("古巴比伦")])]),t._v(" "),n("p",[t._v("古巴比伦就是伊拉克！被入侵，建立 新巴比伦王图，国王建立“空中花园”，地理位置特殊，夹在亚洲、欧洲、非洲中间，经常战乱。\n后来成立了伊拉克，石油全球有名，萨达姆当政。打战抢邻国石油，最后引发2003年伊拉克战争，萨达姆被绞死，被恐怖组件ISIS统治")]),t._v(" "),n("blockquote",[n("p",[t._v("古埃及")])]),t._v(" "),n("p",[t._v("埃及被亚历山大带希腊人干掉了。接下来被希腊人统计。金字塔是法老的坟墓。希腊人内乱，后又被罗马干掉，再被阿拉伯人统治，最后变成英国殖民地。现在穷！")]),t._v(" "),n("blockquote",[n("p",[t._v("希腊")])]),t._v(" "),n("p",[t._v("希腊：宙斯。环境好。一堆小岛，各自称王。形成城邦国家。团结打败入侵的波斯，小兵报喜，创立了马拉松长跑。又内乱了。最后被亚历山大入侵统治，此时发展最好，有苏格拉底、柏拉图。被罗马征服，被土耳其剥削\n最后独立。国家没钱，借钱还不起。四年一次的奥运会要去希腊取圣火。")]),t._v(" "),n("blockquote",[n("p",[t._v("罗马，西罗马变成意大利")])]),t._v(" "),n("p",[t._v("凯撒大帝 扑克方块K, 屋大维时，罗马帝国几乎代表整个欧洲。后来分成东西罗马帝国。意大利属于西罗马帝国。意大利被匈奴入侵，被打败。意大利分列成小国。出现了基督教，社会大乱，黑暗的中世纪，持续1000年。然后达芬奇出现，文艺复兴，这让有钱人看到希望。此时意大利被其他国家统治。最后独立。一二战很垃圾。现在米兰有时装和模特。还有威尼斯水城。")]),t._v(" "),n("h2",{attrs:{id:"http-1-1"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http-1-1"}},[t._v("#")]),t._v(" http/1.1")]),t._v(" "),n("p",[t._v("超文本传输协议： HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范")]),t._v(" "),n("p",[t._v("超文本：包含文字、图片、视频等广义上的文本")]),t._v(" "),n("ol",[n("li",[t._v("明文传输不安全，HTTP 协议的实现本身非常简单，不论是谁发送过来的请求都会返回响应")]),t._v(" "),n("li",[t._v("无法证明请求报文和响应报文的完整性，可能被篡改")])]),t._v(" "),n("p",[t._v("http协议由请求头Request Header或响应头Respose Header,统称Header 和body(消息正文)组成，body非必须")]),t._v(" "),n("p",[t._v("http默认端口80")]),t._v(" "),n("h3",{attrs:{id:"网络模型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络模型"}},[t._v("#")]),t._v(" 网络模型")]),t._v(" "),n("p",[t._v("应用层：HTTP协议，SMTP(电子邮件传送协议)，FTP(文件上传协议)，DNS(域名解析协议)")]),t._v(" "),n("p",[t._v("传输层：TCP协议、UDP协议")]),t._v(" "),n("p",[t._v("网络层：IP协议(使用 "),n("code",[t._v("IP 地址")]),t._v(" 来标识互联网上的每一台计算机)")]),t._v(" "),n("p",[t._v("链路层：网络（以太网、WiFi）")]),t._v(" "),n("p",[t._v("客户端在应用层（HTTP协议）发出一个想看"),n("code",[t._v("http://www.baidu.com")]),t._v(" 页面的http请求,为了传输方便，在传输层(TCP协议)把接收到的数据(HTTP请求报文)进行分割处理，在网络层(IP协议)增加MAC地址后转发到链路层(网络) 。接收端的服务器在链路层接收到数据， -> 网络层 -> 传输层 -- 应用层，当传输到应用层，才算接收到客户端发送过来的http请求")]),t._v(" "),n("p",[t._v("客户端： 应用层 http协议 --  传输层 TCP协议 -- 网络层 IP协议 ------\x3e 链路层 网络")]),t._v(" "),n("p",[t._v("服务器： 链路层 网络 -- 网络层 IP协议 -- 传输层 TCP协议 -----\x3e 应用层http协议")]),t._v(" "),n("h3",{attrs:{id:"ip协议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ip协议"}},[t._v("#")]),t._v(" IP协议")]),t._v(" "),n("p",[t._v("把数据包传送给对方。利用IP地址和MAC地址")]),t._v(" "),n("h3",{attrs:{id:"tcp协议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp协议"}},[t._v("#")]),t._v(" TCP协议")]),t._v(" "),n("p",[t._v("为了更容易传送大数据才把数据分割，能够确认数据最终是否送达到对方。采用了三次握手策略")]),t._v(" "),n("h3",{attrs:{id:"tcp连接三次握手-四次挥手"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#tcp连接三次握手-四次挥手"}},[t._v("#")]),t._v(" TCP连接三次握手,四次挥手")]),t._v(" "),n("p",[t._v("建立TCP连接需要三次握手：")]),t._v(" "),n("ol",[n("li",[t._v("客户端向服务器发起连接请求，")]),t._v(" "),n("li",[t._v("服务器收到后（确认客户端连接正常），向客户端发收到请求。")]),t._v(" "),n("li",[t._v("客户端收到后（确认自己和服务器都连接正常）发确认连接请求（让服务器确认自己连接正常），建立连接。")])]),t._v(" "),n("p",[t._v("关闭TCP连接需要四次挥手：")]),t._v(" "),n("ol",[n("li",[t._v("客户端发出关闭连接请求")]),t._v(" "),n("li",[t._v("服务器发出是否关闭请求")]),t._v(" "),n("li",[t._v("客户端发出确认关闭请求")]),t._v(" "),n("li",[t._v("服务器发出已关闭信息。")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(352),alt:"image-20200731181433669"}})]),t._v(" "),n("h3",{attrs:{id:"地址栏输入url过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#地址栏输入url过程"}},[t._v("#")]),t._v(" 地址栏输入URL过程")]),t._v(" "),n("ol",[n("li",[t._v("我们在地址栏输入URL（即网址，如"),n("code",[t._v("http://www.baidu.com")]),t._v("）")]),t._v(" "),n("li",[t._v("DNS服务器会首先进行"),n("strong",[t._v("域名映射")]),t._v("。找到对应的IP地址。")]),t._v(" "),n("li",[t._v("http客户端建立起"),n("strong",[t._v("TCP连接")]),t._v("。")]),t._v(" "),n("li",[t._v("发送http"),n("strong",[t._v("请求报文")]),t._v("，http服务器解析报文，获取数据封装到http"),n("strong",[t._v("响应报文")]),t._v("，发给用户。")]),t._v(" "),n("li",[t._v("客户接到响应报文后，"),n("strong",[t._v("断开TCP")]),t._v("连接。")]),t._v(" "),n("li",[t._v("HTTP客户端从响应报文提取出html响应文件。通过浏览器显示出来。")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(353),alt:"image-20200731181433669"}})]),t._v(" "),n("h3",{attrs:{id:"cdn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cdn"}},[t._v("#")]),t._v(" CDN")]),t._v(" "),n("p",[t._v("是构建在现有网络基础之上的网络，它依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户"),n("strong",[t._v("就近")]),t._v("获取所需内容 。  缓存、代理、分发等")]),t._v(" "),n("h3",{attrs:{id:"dns协议"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dns协议"}},[t._v("#")]),t._v(" DNS协议")]),t._v(" "),n("p",[t._v("把 IP 地址转换为便于人类记忆的协议 ，DNS 协议提供通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。")]),t._v(" "),n("h3",{attrs:{id:"uri"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#uri"}},[t._v("#")]),t._v(" URI")]),t._v(" "),n("p",[t._v("唯一地标记互联网上资源:  包含URL(网址)+URN(统一资源名称)")]),t._v(" "),n("h3",{attrs:{id:"cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cookie"}},[t._v("#")]),t._v(" cookie")]),t._v(" "),n("p",[t._v("http是不保存状态的协议，不对请求和响应之间的通信状态进行保存，为了保持用户的登陆状态，出现了cookie")]),t._v(" "),n("h3",{attrs:{id:"if-modified-since"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#if-modified-since"}},[t._v("#")]),t._v(" If-Modified-since")]),t._v(" "),n("p",[t._v("请求头出现 If-Modified-since: Thu, 12 Jul 2012 07:30:00 GMT 服务器会响应仅返回这个时间以后更新过的index.html页面资源，如果未有内容更新，则以304 Not Modified作为响应返回")]),t._v(" "),n("p",[t._v("相关资料在6.4.9")]),t._v(" "),n("h3",{attrs:{id:"get-post-put-head-delete-options"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#get-post-put-head-delete-options"}},[t._v("#")]),t._v(" get post put head delete options")]),t._v(" "),n("p",[t._v("PUT 可传输文件，但http/1.1的put方法不带验证机制，任何人都可以上传文件，不安全，不使用")]),t._v(" "),n("p",[t._v("delete删除文件，也不安全，不使用")]),t._v(" "),n("p",[t._v("head 获得报文首部，用于确认 URI 的有效性及资源更新的日期时间等。少用")]),t._v(" "),n("p",[t._v("options 查询针对请求URI指定的资源支持的方法（返回 Allow: get post,head等）")]),t._v(" "),n("p",[t._v("这些都跟具体应用不太一样。。")]),t._v(" "),n("h3",{attrs:{id:"keep-alive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#keep-alive"}},[t._v("#")]),t._v(" keep-alive")]),t._v(" "),n("p",[t._v("http1.1以前，当请求包含多张图片的html链接时")]),t._v(" "),n("ol",[n("li",[t._v("获取html文档：建立TCP连接，HTTP请求/响应，断开TCP连接")]),t._v(" "),n("li",[t._v("获取图片1：建立TCP连接，HTTP请求/响应，断开TCP连接")]),t._v(" "),n("li",[t._v("获取图片N: 建立TCP连接，HTTP请求/响应，断开TCP连接")])]),t._v(" "),n("p",[t._v("会不断地建立TCP连接，每次的请求都会造成无谓的 TCP 连接建立和断开，增加通信量的开销。")]),t._v(" "),n("p",[t._v("Connection:close  非持久连接，要求服务器发送完响应的对象后就关闭连接")]),t._v(" "),n("p",[t._v("此时出现了持久连接 keep-alive 即保持TCP连接状态，一次性发完所有http请求/响应。")]),t._v(" "),n("p",[t._v("在http/1.1中，所有连接默认都是持久连接  "),n("code",[t._v("Connection: keep-alive")])]),t._v(" "),n("h3",{attrs:{id:"range"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#range"}},[t._v("#")]),t._v(" Range")]),t._v(" "),n("p",[t._v("响应头包含 Content-Range (请求一个10000字节的资源，断网后，使用范围请求，可以只请求剩余的5001~10000的部分数据)")]),t._v(" "),n("p",[t._v("请求头 range:bytes=0-")]),t._v(" "),n("p",[t._v("响应头 accept-ranges:bytes")]),t._v(" "),n("p",[t._v("​\t\t\tContent-Range: bytes 0-34343/343434")]),t._v(" "),n("p",[t._v("ETag")]),t._v(" "),n("p",[t._v("接口的response data 才有  6.5.3")]),t._v(" "),n("h3",{attrs:{id:"管线化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#管线化"}},[t._v("#")]),t._v(" 管线化")]),t._v(" "),n("p",[t._v("持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。")]),t._v(" "),n("p",[t._v("这样就能够做到同时并行发送多个请求，而不需要一个接一个地等待响应了。")]),t._v(" "),n("h3",{attrs:{id:"状态码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#状态码"}},[t._v("#")]),t._v(" 状态码")]),t._v(" "),n("p",[t._v("204 请求成功，没资源可返回")]),t._v(" "),n("p",[t._v("206 范围请求Range-Request")]),t._v(" "),n("p",[t._v("401 未认证Unauthorized")]),t._v(" "),n("p",[t._v("403 Forbidden 没权限")]),t._v(" "),n("p",[t._v("500 Internal Server Error")]),t._v(" "),n("p",[t._v("503 Service Unavailable(服务器处于超负载或停机维护)")]),t._v(" "),n("h3",{attrs:{id:"代理服务器-via"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代理服务器-via"}},[t._v("#")]),t._v(" 代理服务器 Via")]),t._v(" "),n("p",[t._v("接收客户端发送的请求后转发给其他服务器。每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息。就是 响应头的 Via 。 利用缓存技术减少网络带宽的流量。包含"),n("strong",[t._v("缓存服务器")])]),t._v(" "),n("h3",{attrs:{id:"网关服务器-via"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网关服务器-via"}},[t._v("#")]),t._v(" 网关服务器 Via")]),t._v(" "),n("p",[t._v("转发其他服务器通信数据，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。应用：购买用信息卡结算时，网关可以和信用卡结算系统联动。")]),t._v(" "),n("h2",{attrs:{id:"xmlhttprequest-express"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#xmlhttprequest-express"}},[t._v("#")]),t._v(" XMLHttpRequest + express")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v("// url:  http://localhost:8888/pcgomweb/1.html\n"),n("span",{pre:!0,attrs:{class:"token doctype"}},[t._v("<!DOCTYPE html>")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Title"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),n("span",{pre:!0,attrs:{class:"token script"}},[n("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 原生 + express")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://localhost:3000/'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" xmlhttp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 请求成功")]),t._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'submit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置请求头")]),t._v("\n    xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"res="')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    age"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// node api.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cors "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cors'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" bodyParser "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body-parser'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 获取 post 请求参数    req.body")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" arr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cors")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 跨域")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 添加json解析")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bodyParser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("urlencoded")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("extended"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/a'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aaa'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/age'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// post")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/submit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("parse")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  arr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" age"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'arr'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    result"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'haha'")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Example app listening on port 3000!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"接口请求头-响应头"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#接口请求头-响应头"}},[t._v("#")]),t._v(" 接口请求头/响应头")]),t._v(" "),n("p",[t._v("请求头")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" */*\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Encoding:")]),t._v(" gzip, deflate, br\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Language:")]),t._v(" zh-CN,zh;q=0.9\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control:")]),t._v(" no-cache   // 默认不缓存\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" keep-alive\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length:")]),t._v(" 14\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-type:")]),t._v(" application/x-www-form-urlencoded  // 这个是设置的，其他都是默认的\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" localhost:3000   // api服务器域名\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Origin:")]),t._v(" http://localhost:8888  // 本地服务器域名\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Pragma:")]),t._v(" no-cache\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Referer:")]),t._v(" http://localhost:8888/pcgomweb/1.html  //  当前链接\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Dest:")]),t._v(" empty\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Mode:")]),t._v(" cors\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Site:")]),t._v(" same-site\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("User-Agent:")]),t._v(" Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\n")])])]),n("p",[t._v("响应头")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Access-Control-Allow-Origin:")]),t._v(" *    // 这个是设置的，其他都是默认的\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" keep-alive\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Length:")]),t._v(" 17\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Content-Type:")]),t._v(" application/json; charset=utf-8   // 这个是设置的 res.json()\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Date:")]),t._v(" Wed, 26 Aug 2020 03:06:42 GMT\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("ETag:")]),t._v(' W/"11-AUjVioKC+y0tfWxgttKaPngTxTA"\n'),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-Powered-By:")]),t._v(" Express         // 框架\n")])])]),n("h3",{attrs:{id:"index-html请求头-响应头"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#index-html请求头-响应头"}},[t._v("#")]),t._v(" index.html请求头/响应头")]),t._v(" "),n("p",[t._v("请求头")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9    // q是权重 0~1\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Encoding:")]),t._v(" gzip, deflate, br\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept-Language:")]),t._v(" zh-CN,zh;q=0.9\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cache-Control:")]),t._v(" no-cache    // 默认不缓存\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Connection:")]),t._v(" keep-alive\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Cookie:")]),t._v(" Hm_lvt_3c187470b692e2d95f347970c5f35210=1597384818\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Host:")]),t._v(" localhost:8888\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Pragma:")]),t._v(" no-cache   // HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义。没啥用\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Dest:")]),t._v(" document\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Mode:")]),t._v(" navigate\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-Site:")]),t._v(" none\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Sec-Fetch-User:")]),t._v(" ?1\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Upgrade-Insecure-Requests:")]),t._v(" 1\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("User-Agent:")]),t._v(" Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\n")])])]),n("p",[t._v("index.html响应头")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("cache-control:")]),t._v(" private, must-revalidate\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-length:")]),t._v(" 680\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-type:")]),t._v(" text/html\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("date:")]),t._v(" Wed, 26 Aug 2020 03:36:16 GMT\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("last-modified:")]),t._v(" Wed, 26 Aug 2020 03:11:06 GMT\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("server:")]),t._v(" WebStorm 2018.3.5\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-Content-Type-Options:")]),t._v(" nosniff\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("X-Frame-Options:")]),t._v(" SameOrigin   // 防止点击劫持攻击  SameOrigin同源域名   6.8.1\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("x-xss-protection:")]),t._v(" 1; mode=block  // 跨站脚本攻击XSS  1有效  0 无效\n")])])]),n("p",[t._v("css、js文件请求头基本跟html一样")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" text/css,*/*;q=0.1  // css\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Accept:")]),t._v(" */*  // js \n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Referer:")]),t._v(" http://localhost:8888/pcgomweb/1.html?_ijt=949tra7ie563giij14nna8itnh\n")])])]),n("p",[t._v("response headers")]),t._v(" "),n("div",{staticClass:"language-http extra-class"},[n("pre",{pre:!0,attrs:{class:"language-http"}},[n("code",[n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-type:")]),t._v(" text/css                 // css\n"),n("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-type:")]),t._v(" application/javascript   // js\n")])])]),n("h2",{attrs:{id:"https"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#https"}},[t._v("#")]),t._v(" HTTPS")]),t._v(" "),n("p",[t._v("超文本传输安全协议（http secure)")]),t._v(" "),n("p",[t._v("在HTTP 的基础上增加了 "),n("code",[t._v("SSL")]),t._v(" 层（公开密钥加密方式），添加了加密及认证机制，就是HTTPS")]),t._v(" "),n("p",[t._v("https默认端口443")]),t._v(" "),n("p",[t._v("https比http要慢2~100倍，SSL通信慢、加密耗时。因此，非敏感信息用http通信，包含个人信息等敏感数据用https加密通信。https还需要购买证书，一年600元左右")]),t._v(" "),n("h3",{attrs:{id:"共享-对称-密钥加密"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#共享-对称-密钥加密"}},[t._v("#")]),t._v(" 共享(对称)密钥加密")]),t._v(" "),n("p",[t._v("客户和服务器用"),n("strong",[t._v("同一个密钥")]),t._v("来加密解密")]),t._v(" "),n("h3",{attrs:{id:"公开-非对称-密钥加密"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#公开-非对称-密钥加密"}},[t._v("#")]),t._v(" 公开(非对称)密钥加密")]),t._v(" "),n("p",[t._v("使用"),n("strong",[t._v("一对")]),t._v("非对称的密钥。发送密文的一方"),n("strong",[t._v("使用对方的公开密钥")]),t._v("进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。")]),t._v(" "),n("p",[n("strong",[t._v("HTTPS 采用两者混合加密机制")])]),t._v(" "),n("p",[t._v("公开密钥加密太复杂，于是用来"),n("strong",[t._v("加密共享密钥")]),t._v("，确保密钥安全后，使用"),n("strong",[t._v("这个密钥")]),t._v("进行共享密钥加密通信。")]),t._v(" "),n("p",[t._v("使用CA等认证机构发布的公开密钥证书证明公开密钥的正确性。这些证书内置于浏览器中。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(354),alt:"image-20200731181433669"}})]),t._v(" "),n("h3",{attrs:{id:"对称加密-rsa-中间人攻击"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#对称加密-rsa-中间人攻击"}},[t._v("#")]),t._v(" 对称加密 rsa 中间人攻击")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("对称加密： 公用一个密钥 key来加密解密数据， 这个密钥无法传输\n\nrsa非对称加密：  双方各有一对私钥和公钥， 用a的公钥加密，a收到数据时，用自己的私钥解密。   问题：rsa慢。\n\n两者结合： 用rsa传递对称加密密钥key, 传完用key来加密解密数据。\n\n中间人攻击： a发公钥给b时，被中间人换了，b以为是a的公钥，就用它加密了。发回给a时，又被中间人截取了，还能解密。信息就泄露了。\n\nhttps://juejin.cn/post/6844903718182354951\n")])])]),n("p",[t._v("第7章")]),t._v(" "),n("h3",{attrs:{id:"ajax"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ajax"}},[t._v("#")]),t._v(" Ajax")]),t._v(" "),n("p",[t._v("社区论坛要实时显示用户提交的数据，传统http需要频繁地从客户端到服务器进行确认是否有新数据（http瓶颈），利用Ajax 和dom 来请求服务器，更新部分页面")]),t._v(" "),n("h3",{attrs:{id:"websocket"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#websocket"}},[t._v("#")]),t._v(" WebSocket")]),t._v(" "),n("p",[t._v("长连接 替代验证票的定时器")]),t._v(" "),n("p",[t._v("建立在http基础上，解决http瓶颈。一旦客户端和服务器建立WebSocket连接，两者可直接向对方发送报文、推送数据。WebSocket连接一直保持连接状态。")]),t._v(" "),n("p",[t._v("建立连接 请求头 "),n("code",[t._v("upgrade:websocket")]),t._v(" 响应头 "),n("code",[t._v("101 Switching Protocols")])]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSocket")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ws://xxx'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nsock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("emit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("数据"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 提交数据   ")]),t._v("\nsock"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'name'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//接收数据    客户端和服务器都有这两个方法")]),t._v("\n前端  ： https"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("github"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("socketio"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("socket"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("client\n")])])]),n("h2",{attrs:{id:"网络安全"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络安全"}},[t._v("#")]),t._v(" 网络安全")]),t._v(" "),n("h3",{attrs:{id:"xss"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#xss"}},[t._v("#")]),t._v(" xss")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n* xss 攻击预防\n* 目前地址栏的xss : http://xxx.html?name=<script>alert(1)<\/script>\n* 输入框，图片，富文本\n* chrome 会自己转义\n* */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 转义 < > \" '  空格不转义")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("escapeHtml")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 地址栏的xss已经先被chrome 转义了，这代码无效了")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/&/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&amp;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/</g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&lt;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/>/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&gt;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v('/"/g')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&quto;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/'/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'&#39;'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// html实体")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" str\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// js 转义")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 地址栏的xss已经先被chrome 转义了，这代码无效了")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// let url = JSON.stringify(xx),")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n* 富文本xss 过滤\n* 黑名单过滤\n* 白名单允许\n* 插件 npm i xss\n* */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 富文本过滤")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("str")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 黑名单过滤太多太麻烦")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/<\\s*\\/?script\\s*>/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 过滤 <script>")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/javascript:[^'\"]*/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 过滤 javascript:alert(1)")]),t._v("\n  str "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/onerror\\s*=\\s*['\"]?[^'\"]*['\"]?/g")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 过滤 onerror")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" str"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cheerio 解析html, 语法类似 jq")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter2")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("html")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" cheerio "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cheerio'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入 cheerio")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" $ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" cheerio"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("load")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 白名单")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" whiteList "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'img'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'src'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'font'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'color'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'size'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'href'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("each")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("index"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("whiteList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("elem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 清空白名单不存在的标签")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" attr "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" elem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attribs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("whiteList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("elem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("indexOf")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("attr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("attr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 清空白名单不存在属性")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// npm i xss  使用第三方库解决白名单")]),t._v("\n")])])]),n("h3",{attrs:{id:"csp"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#csp"}},[t._v("#")]),t._v(" csp")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n* csp  内容安全策略，用于指定哪些内容可执行\n* 预防xss 攻击\n*\n*  <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self'; img-src https://*; child-src 'none';\">\n*    详见 https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\n* */")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// nodejs 防xss")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ctx.set('X-XSS-Protection',1);  // 0是关闭 1是打开防御  功能不全面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ctx.set(`Content-Security-Policy`,`default-src 'self'`)  //csp内容安全策略")]),t._v("\n")])])]),n("h3",{attrs:{id:"csrf"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#csrf"}},[t._v("#")]),t._v(" csrf")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n*  CSRF： 第三方网站不用访问你的网站，就拿到你的信息，并调用你的接口乱来\n*\n*  打开某网站A，自己的账号信息保存在cookie中被获取，导致自己银行卡的钱丢了\n*  1.设置cookie只能本网站访问\n*   cookie.set(sameSite = Strict)\n*\n*  2.加图形验证码/TOKEN等，必须经过本网站，防CSRF\n*  nodejs npm i ccap 生成图形验证码\n*\n*  3.加 token ，必须经过本网站，防CSRF，  token的用户体验比图形验证码好\n*\n*  4. referer 不是很好，有些访问没有referer\n*  验证referer值 禁止来自第三方网站的请求\n*  // nodejs\n*  var referer = ctx.reques.headers.referer;\n*  if(!/^https?:\\/\\/localhost/.test(referer)){\n*     console.log('error')\n*  }\n* */")]),t._v("\n")])])]),n("h3",{attrs:{id:"点击劫持"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#点击劫持"}},[t._v("#")]),t._v(" 点击劫持")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n*  点击劫持：原理：自己的网站被第三方用Iframe内嵌，\n *  自己点击跳出来的网站后，发现自己的钱没了。\n*  垃圾邮件点击劫持\n*  本网站禁止内嵌，防止点击劫持\n*  nodejs  ctx.set('X-Frame-Options','DENY');  禁止页面内嵌  兼容ie8\n* */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果有iframe嵌入的话，两者值不一致，一刷新假页面，页面会跳转到真正的页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果被禁止js 则以下代码无效了")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  top"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <iframe sandbox = '' >  iframe 的sandbox 可以禁用 js 等一堆功能")]),t._v("\n")])])]),n("h3",{attrs:{id:"其他"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// http协议 窃听，篡cuan改")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//    生成ca证书，放入项目中，引用ca证书，使用https来访问，proxy代理抓包则看不到任何请求数据")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n* 密码 md5等加密  mysql 注入  文件上传漏洞(后端文件内容检查、用nginx读取文件再返回、控制读写权限等，nodejs问题不大)\n* */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 防止盗QQ，盗身份证进信息等   OAuth 引入  使用QQ登陆某网站，使用了用户授权")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// cdn 加速 防dns攻击 https加密  token 时间戳， 签名")]),t._v("\n")])])]),n("h2",{attrs:{id:"相关链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相关链接"}},[t._v("#")]),t._v(" 相关链接")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/6844904045572800525#heading-12",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://segmentfault.com/a/1190000023731992",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("书籍： 图解http")]),t._v(" "),n("p",[t._v("书籍：http/2基础教程  2018.1")]),t._v(" "),n("h2",{attrs:{id:"问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),n("h3",{attrs:{id:"http2-0-3-0"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http2-0-3-0"}},[t._v("#")]),t._v(" HTTP2.0 3.0")]),t._v(" "),n("p",[t._v("非对称加密")]),t._v(" "),n("p",[t._v("chrome开发者工具")]),t._v(" "),n("h2",{attrs:{id:"http-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http-2"}},[t._v("#")]),t._v(" HTTP/2")]),t._v(" "),n("p",[t._v("简称h2，书《http/2基础教程》看不懂。")]),t._v(" "),n("h3",{attrs:{id:"http-2网站判断"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http-2网站判断"}},[t._v("#")]),t._v(" http/2网站判断")]),t._v(" "),n("ol",[n("li",[n("a",{attrs:{href:"https://www.dute.org/http2",target:"_blank",rel:"noopener noreferrer"}},[t._v("http/2 检测工具"),n("OutboundLink")],1),t._v("   链接必须带上https")]),t._v(" "),n("li",[t._v("chrome 如果响应头有 view source 点进去就可以查看http版本，如果没有view source，说明是http2, 因为http2是采用二进制传输")]),t._v(" "),n("li",[t._v("chrome network 右键勾选 protocol")])]),t._v(" "),n("p",[t._v("https://m.caijiyouxi.com/m/alpha/rescuePlan/index.html  支持http/2.0")]),t._v(" "),n("p",[t._v("百度首页居然是http/1.1")]),t._v(" "),n("p",[t._v("延迟 带宽 DNS查询 建立连接时间 TLS协商时间 首字节时间（TTFB)  内容下载时间 开始渲染时间 文档加载完成时间 更多的字节 更多的资源 更高的复杂度 更多的域名 更多的TCP socket")]),t._v(" "),n("h3",{attrs:{id:"http-1瓶颈"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http-1瓶颈"}},[t._v("#")]),t._v(" http/1瓶颈")]),t._v(" "),n("p",[t._v("队头阻塞： http/1 的管道化允许一次发送一组请求，但只能按照发送顺序依次接收响应，如果某个资源出现问题，剩下所有的工作都会被阻塞在那次请求应答之后。会阻碍网络传输和 Web 页面渲染，直至失去响应")]),t._v(" "),n("p",[t._v("低效的TCP利用：")]),t._v(" "),n("div",{staticClass:"language-html extra-class"},[n("pre",{pre:!0,attrs:{class:"language-html"}},[n("code",[t._v('<link rel="dns-prefetch" href="//ajax.googleapis.com>\n')])])]),n("p",[n("strong",[t._v("HTTP/1优化技巧，以及HTTP/2的相关建议")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"left"}},[t._v("名称")]),t._v(" "),n("th",{staticStyle:{"text-align":"left"}},[t._v("描述")]),t._v(" "),n("th",{staticStyle:{"text-align":"left"}},[t._v("备注")])])]),t._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("资源合并")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("把多个文件（javascript、css）合成一个文件，以减少 http 请求")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("在 http/2 下这并非必要，因为请求的传输字节数和时间成本更低，虽然这种成本仍然存在")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("极简化")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("去除 html、javascript、css 这类文件中无用的代码")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("很棒的做法，在 http/2 下也要保留")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("域名拆分")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("把资源分布到不同的域名上面去，让浏览器利用更多的 socket 连接")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("http/2 的设计意图是充分利用单个 socket 连接，而拆分域名会违背这种意图。建议取消域名拆分，但请注意本表格之后的附注框会介绍这个问题相关的各种复杂情况")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("禁用 cookie 的域名")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("为图片之类的资源建立单独的域名，这些域名不用 cookie，以尽可能减少请求尺寸")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("应该避免为这些资源单独设立域名（参见“域名拆分”），但更重要的是，由于 http/2 提供了首部压缩，cookie 的开销会显著降低")])]),t._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"left"}},[t._v("生成精灵图")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("把多张图片拼合为一个文件，使用 css 控制在 web 页面上展示的部分")]),t._v(" "),n("td",{staticStyle:{"text-align":"left"}},[t._v("与极简化类似，只不过用 css 实现这种效果的代价高昂；不推荐在 http/2 中使用")])])])]),t._v(" "),n("p",[t._v("tengine")]),t._v(" "),n("p",[t._v("淘宝的web服务器，在nginx的基础上，针对大访问量网站的"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E9%9C%80%E6%B1%82/3543925",target:"_blank",rel:"noopener noreferrer"}},[t._v("需求"),n("OutboundLink")],1),t._v("，添加了很多高级功能和特性")]),t._v(" "),n("h3",{attrs:{id:"http2优势"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http2优势"}},[t._v("#")]),t._v(" http2优势")]),t._v(" "),n("ol",[n("li",[t._v("二进制分帧层，http1是明文传输")]),t._v(" "),n("li",[t._v("多路复用，同一域名只创建一个连接，实现多请求-响应并行，解决了线头阻塞的问题，减少了 TCP 连接数量和 TCP 连接慢启动造成的问题")]),t._v(" "),n("li",[t._v("服务器推送")]),t._v(" "),n("li",[t._v("Header 压缩")])]),t._v(" "),n("p",[n("a",{attrs:{href:"https://blog.fundebug.com/2019/03/07/understand-http2-and-http3/",target:"_blank",rel:"noopener noreferrer"}},[t._v("一文读懂 HTTP/2 及 HTTP/3 特性"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"升级为http2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#升级为http2"}},[t._v("#")]),t._v(" 升级为http2")]),t._v(" "),n("div",{staticClass:"language-nginx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-nginx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 版本必须大于 1.9.x 查版本命令 nginx -v")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# /etc/nginx/nginx.conf ")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重点就是这里加http2")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("listen")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ssl")]),t._v(" http2 default_server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);