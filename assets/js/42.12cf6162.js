(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{408:function(t,s,a){"use strict";a.r(s);var e=a(42),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"nestjs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nestjs"}},[t._v("#")]),t._v(" nestjs")]),t._v(" "),a("h2",{attrs:{id:"sh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sh"}},[t._v("#")]),t._v(" sh")]),t._v(" "),a("p",[t._v("shell脚本")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env bash    // 第一行")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'abc'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function-name function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'test'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("  // 执行\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$#")]),t._v("  // 传参个数\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("abDir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v("  // 内置参数   当前路径\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("dir")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${abDir"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("##")]),t._v("*"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("}")]),t._v("  删掉最后一个 / 及其左边的字符串：my.file.txt\n\n// 如果参数个数小于2执行 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$#")]),t._v(" -lt "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v('"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-h"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("service")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${1}")]),t._v(" // 第一个参数\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v("}")]),t._v("  // 当前用户\n// 取出git branch 列表传给awk，找出列表中第一个参数为* ，并打印出第二个参数值，即当前分支名\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("branch")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" branch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$1")]),t._v(' == "*"{print '),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$2")]),t._v("}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("date")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),t._v(" +%s"),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" 当前时间戳，单位秒\n")])])]),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/zhml8951/article/details/51906836",target:"_blank",rel:"noopener noreferrer"}},[t._v("##*/"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"set-e"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-e"}},[t._v("#")]),t._v(" set -e")]),t._v(" "),a("p",[t._v("若指令传回值不等于0，则立即退出shell。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.runoob.com/linux/linux-comm-set.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("linux set命令"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v('在"set -e"之后出现的代码，一旦出现了返回值非零，整个脚本就会立即退出。有的人喜欢使用这个参数，是出于保证代码安全性的考虑。但有的时候，这种美好的初衷，也会导致严重的问题。')]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.jianshu.com/p/277ef9d192a2",target:"_blank",rel:"noopener noreferrer"}},[t._v("set -e"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"获取short-commit-id（如：bb4f92a）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取short-commit-id（如：bb4f92a）"}},[t._v("#")]),t._v(" 获取short commit id（如：bb4f92a）")]),t._v(" "),a("p",[t._v("git rev-parse --short HEAD")]),t._v(" "),a("h3",{attrs:{id:"curl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#curl"}},[t._v("#")]),t._v(" curl")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.coonote.com/linux/linux-cmd-curl.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("curl"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("文件传输工具（上传下载）")]),t._v(" "),a("p",[t._v("curl http://xxx? \\")]),t._v(" "),a("p",[t._v('-F "SUSE=XXX.tgz"   上传打包后的文件')]),t._v(" "),a("h3",{attrs:{id:"tar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tar"}},[t._v("#")]),t._v(" tar")]),t._v(" "),a("p",[t._v("cd ../")]),t._v(" "),a("p",[t._v("tar -czf xx.tgz ./xxx    // 上一行 cd.. 先进到相应的目录再 tar    不能直接  ../xxx")]),t._v(" "),a("p",[t._v("压缩 xxx目录为 xx.tgz")]),t._v(" "),a("p",[t._v("-c 建立新的备份文件")]),t._v(" "),a("p",[t._v("-z  通过gzip指令处理备份文件。")]),t._v(" "),a("p",[t._v("-f  指定文件")]),t._v(" "),a("h2",{attrs:{id:"ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh"}},[t._v("#")]),t._v(" ssh")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ssh")]),t._v(" username@127.0.0.1 -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2222")]),t._v(" -i  ~/.ssh/config\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" etc/passwd 查 ssh登陆目录\n")])])]),a("p",[t._v("https://www.jianshu.com/p/59c4fc2684be\nhttps://www.cnblogs.com/zongzi10010/p/11945178.html")]),t._v(" "),a("h2",{attrs:{id:"nest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nest"}},[t._v("#")]),t._v(" nest")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000040207165",target:"_blank",rel:"noopener noreferrer"}},[t._v("一对多，多对一"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql"}},[t._v("#")]),t._v(" mysql")]),t._v(" "),a("p",[t._v("mysql-5.7.27-winx64.zip 免安装")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/rysinal/p/7565259.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("教程"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"postman"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#postman"}},[t._v("#")]),t._v(" postman")]),t._v(" "),a("p",[t._v("chrome下载 postman rest client插件")]),t._v(" "),a("p",[t._v("192.168.3.87:3008/tigers   查询")]),t._v(" "),a("p",[t._v("controllers的注解是接口查询方式")]),t._v(" "),a("h2",{attrs:{id:"docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[t._v("#")]),t._v(" docker")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("安装docker ce windows版本  20201023   Docker Engine  v19.03.13")]),t._v(" "),a("h3",{attrs:{id:"image"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#image"}},[t._v("#")]),t._v(" image")]),t._v(" "),a("p",[t._v("cmd")]),t._v(" "),a("p",[t._v("查看  "),a("code",[t._v("docker image ls")])]),t._v(" "),a("p",[t._v("获取 "),a("code",[t._v("docker imag pull library/hello-world")])]),t._v(" "),a("p",[t._v("运行 "),a("code",[t._v("docker container run hello-world")])]),t._v(" "),a("p",[t._v("创建 "),a("code",[t._v("docker image build -t node-express .")])]),t._v(" "),a("h3",{attrs:{id:"container-容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#container-容器"}},[t._v("#")]),t._v(" container 容器")]),t._v(" "),a("p",[t._v("docker container list --all")]),t._v(" "),a("h2",{attrs:{id:"制作自己的docker-容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#制作自己的docker-容器"}},[t._v("#")]),t._v(" 制作自己的Docker 容器")]),t._v(" "),a("p",[t._v("在项目中添加以下文件")]),t._v(" "),a("h3",{attrs:{id:"dockerignore"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerignore"}},[t._v("#")]),t._v(" .dockerignore")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(".git\nnode_modules\n")])])]),a("h3",{attrs:{id:"dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[t._v("#")]),t._v(" Dockerfile")]),t._v(" "),a("div",{staticClass:"language-dockerfile extra-class"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("12.16.3       // node版本 \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COPY")]),t._v(" . /node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("express    // 复制所有文件到  docker里的/node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("express文件夹\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WORKDIR")]),t._v(" /node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("express   // 选择 node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("express文件夹\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("RUN")]),t._v(" yarn                // yarn\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXPOSE")]),t._v(" 3008             // 暴露端口\n")])])]),a("p",[t._v("在项目路径下操作吧，防出错。利用Dockerfile 创建 image 文件"),a("code",[t._v("docker image build -t node-express .")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 生成容器")]),t._v("\ndocker container run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),t._v(":3008 -it node-express "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("/bin/bash\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 8000是可访问端口，3000是Dockerfile的端口， -it 项目映射  最后是启动bash ,路径可能需要调整")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 正常状态如下，可执行命令，如 npm start来运行项目")]),t._v("\nroot@452fff0df368:/node-express"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ctrl + c 停止node服务")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ctrl + d 终止docker")]),t._v("\n")])])]),a("p",[t._v("修改完 Dockerfile 要重新创建image文件和生成容器")]),t._v(" "),a("ol",[a("li",[t._v("要创建image文件 "),a("code",[t._v("docker image build -t node-express .")])]),t._v(" "),a("li",[t._v("生成容器 "),a("code",[t._v("docker container run --rm -p 8000:3008 -it node-express")]),t._v(" 用完删除 --rm")])]),t._v(" "),a("p",[t._v("最后访问的是  localhost:8000/a")]),t._v(" "),a("h3",{attrs:{id:"docker-compose"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[t._v("#")]),t._v(" docker compose")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),a("OutboundLink")],1),t._v("  docker-compose.yml")]),t._v(" "),a("p",[t._v("同时运行多个容器")]),t._v(" "),a("p",[t._v("启动多个容器 "),a("code",[t._v("docker-compose up")])]),t._v(" "),a("p",[t._v("关闭多个容器 "),a("code",[t._v("docker-compose stop")])]),t._v(" "),a("p",[t._v("删除 "),a("code",[t._v("docker-compose rm")])]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.dockerinfo.net/document",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker 文档"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("最终： docker是运行多个项目容器container,  各个容器是在项目中添加 Dockerfile，先生成image，再生成container")]),t._v(" "),a("p",[t._v("Dockerfile 写逻辑， 根据dockerfile生成相应的image,  根据 image文件生成容器container")]),t._v(" "),a("p",[t._v("docker-compose.yml 运行多个容器")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://c.biancheng.net/docker/",target:"_blank",rel:"noopener noreferrer"}},[t._v("docker文档"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);