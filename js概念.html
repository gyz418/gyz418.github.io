<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js概念 | gyz418</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.7c4bcbe6.css" as="style"><link rel="preload" href="/assets/js/app.6f322a7c.js" as="script"><link rel="preload" href="/assets/js/2.5281df64.js" as="script"><link rel="preload" href="/assets/js/4.eb70c47d.js" as="script"><link rel="prefetch" href="/assets/js/10.b5b78ec7.js"><link rel="prefetch" href="/assets/js/11.3979c63f.js"><link rel="prefetch" href="/assets/js/12.ad66bd03.js"><link rel="prefetch" href="/assets/js/13.8c156ce0.js"><link rel="prefetch" href="/assets/js/14.d5aaf7c9.js"><link rel="prefetch" href="/assets/js/15.744185ba.js"><link rel="prefetch" href="/assets/js/16.b223ec11.js"><link rel="prefetch" href="/assets/js/17.27940440.js"><link rel="prefetch" href="/assets/js/18.2561b5d6.js"><link rel="prefetch" href="/assets/js/19.bab52827.js"><link rel="prefetch" href="/assets/js/20.64459c18.js"><link rel="prefetch" href="/assets/js/21.95850c08.js"><link rel="prefetch" href="/assets/js/22.8b92906a.js"><link rel="prefetch" href="/assets/js/23.a2fee047.js"><link rel="prefetch" href="/assets/js/24.a1a3b298.js"><link rel="prefetch" href="/assets/js/25.ba19b2b6.js"><link rel="prefetch" href="/assets/js/26.753266fe.js"><link rel="prefetch" href="/assets/js/27.ee58b5d1.js"><link rel="prefetch" href="/assets/js/28.611ffe65.js"><link rel="prefetch" href="/assets/js/29.d446cc43.js"><link rel="prefetch" href="/assets/js/3.d5898f06.js"><link rel="prefetch" href="/assets/js/30.71c0d378.js"><link rel="prefetch" href="/assets/js/31.43e00d33.js"><link rel="prefetch" href="/assets/js/32.a6757d5d.js"><link rel="prefetch" href="/assets/js/33.bfb83c0e.js"><link rel="prefetch" href="/assets/js/34.564690e0.js"><link rel="prefetch" href="/assets/js/35.77a7c9e4.js"><link rel="prefetch" href="/assets/js/36.5e974fda.js"><link rel="prefetch" href="/assets/js/37.f0956a85.js"><link rel="prefetch" href="/assets/js/38.c42b9666.js"><link rel="prefetch" href="/assets/js/39.7262da55.js"><link rel="prefetch" href="/assets/js/40.95d088a9.js"><link rel="prefetch" href="/assets/js/41.f7067891.js"><link rel="prefetch" href="/assets/js/42.12cf6162.js"><link rel="prefetch" href="/assets/js/43.7970973b.js"><link rel="prefetch" href="/assets/js/44.701b85aa.js"><link rel="prefetch" href="/assets/js/45.4c06d258.js"><link rel="prefetch" href="/assets/js/46.e5e18c20.js"><link rel="prefetch" href="/assets/js/47.5d0f9322.js"><link rel="prefetch" href="/assets/js/48.03ad2213.js"><link rel="prefetch" href="/assets/js/49.65826398.js"><link rel="prefetch" href="/assets/js/5.8e0377fa.js"><link rel="prefetch" href="/assets/js/50.8a4a5a58.js"><link rel="prefetch" href="/assets/js/6.49592538.js"><link rel="prefetch" href="/assets/js/7.c7371c19.js"><link rel="prefetch" href="/assets/js/8.78f8209a.js"><link rel="prefetch" href="/assets/js/9.823e0afe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7c4bcbe6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">gyz418</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/前端/ts.html" class="nav-link">
  ts
</a></li><li class="dropdown-item"><!----> <a href="/前端/flutter.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/前端/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/前端/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/前端/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/前端/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/前端/js优化.html" class="nav-link">
  js优化
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue2源码.html" class="nav-link">
  vue2源码
</a></li><li class="dropdown-item"><!----> <a href="/前端/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue3.html" class="nav-link">
  vue3
</a></li><li class="dropdown-item"><!----> <a href="/前端/js设计模式.html" class="nav-link">
  js设计模式
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/前端/package.json.html" class="nav-link">
  package.json
</a></li><li class="dropdown-item"><!----> <a href="/前端/github.html" class="nav-link">
  github
</a></li><li class="dropdown-item"><!----> <a href="/前端/eslint.html" class="nav-link">
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/前端/nestjs.html" class="nav-link">
  nestjs
</a></li><li class="dropdown-item"><!----> <a href="/前端/ueditor.html" class="nav-link">
  ueditor
</a></li><li class="dropdown-item"><!----> <a href="/typescript.html" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gulp.html" class="nav-link">
  gulp
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/js-tools.html" class="nav-link">
  js-tools
</a></li><li class="dropdown-item"><!----> <a href="/js特效.html" class="nav-link">
  js特效
</a></li><li class="dropdown-item"><!----> <a href="/old.html" class="nav-link">
  old
</a></li><li class="dropdown-item"><!----> <a href="/js概念.html" class="nav-link">
  js概念
</a></li><li class="dropdown-item"><!----> <a href="/jest.html" class="nav-link">
  jest
</a></li><li class="dropdown-item"><!----> <a href="/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/service worker.html" class="nav-link">
  service worker
</a></li><li class="dropdown-item"><!----> <a href="/deno.html" class="nav-link">
  deno
</a></li><li class="dropdown-item"><!----> <a href="/swiper.html" class="nav-link">
  swiper
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/chrome.html" class="nav-link">
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/webstorm.html" class="nav-link">
  webstorm
</a></li><li class="dropdown-item"><!----> <a href="/url.html" class="nav-link">
  url
</a></li><li class="dropdown-item"><!----> <a href="/pc.html" class="nav-link">
  pc
</a></li><li class="dropdown-item"><!----> <a href="/festival.html" class="nav-link">
  festival
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/前端/ts.html" class="nav-link">
  ts
</a></li><li class="dropdown-item"><!----> <a href="/前端/flutter.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/前端/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/前端/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/前端/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/前端/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/前端/js优化.html" class="nav-link">
  js优化
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue2源码.html" class="nav-link">
  vue2源码
</a></li><li class="dropdown-item"><!----> <a href="/前端/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue3.html" class="nav-link">
  vue3
</a></li><li class="dropdown-item"><!----> <a href="/前端/js设计模式.html" class="nav-link">
  js设计模式
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/前端/package.json.html" class="nav-link">
  package.json
</a></li><li class="dropdown-item"><!----> <a href="/前端/github.html" class="nav-link">
  github
</a></li><li class="dropdown-item"><!----> <a href="/前端/eslint.html" class="nav-link">
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/前端/nestjs.html" class="nav-link">
  nestjs
</a></li><li class="dropdown-item"><!----> <a href="/前端/ueditor.html" class="nav-link">
  ueditor
</a></li><li class="dropdown-item"><!----> <a href="/typescript.html" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gulp.html" class="nav-link">
  gulp
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/js-tools.html" class="nav-link">
  js-tools
</a></li><li class="dropdown-item"><!----> <a href="/js特效.html" class="nav-link">
  js特效
</a></li><li class="dropdown-item"><!----> <a href="/old.html" class="nav-link">
  old
</a></li><li class="dropdown-item"><!----> <a href="/js概念.html" class="nav-link">
  js概念
</a></li><li class="dropdown-item"><!----> <a href="/jest.html" class="nav-link">
  jest
</a></li><li class="dropdown-item"><!----> <a href="/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/service worker.html" class="nav-link">
  service worker
</a></li><li class="dropdown-item"><!----> <a href="/deno.html" class="nav-link">
  deno
</a></li><li class="dropdown-item"><!----> <a href="/swiper.html" class="nav-link">
  swiper
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/chrome.html" class="nav-link">
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/webstorm.html" class="nav-link">
  webstorm
</a></li><li class="dropdown-item"><!----> <a href="/url.html" class="nav-link">
  url
</a></li><li class="dropdown-item"><!----> <a href="/pc.html" class="nav-link">
  pc
</a></li><li class="dropdown-item"><!----> <a href="/festival.html" class="nav-link">
  festival
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>js概念</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js%E6%A6%82%E5%BF%B5.html#js概念" class="sidebar-link">js概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#js单线程。" class="sidebar-link">JS单线程。</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#网络通信，数据加密" class="sidebar-link">网络通信，数据加密</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#https-就是用了ca证书" class="sidebar-link">https 就是用了CA证书</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#cpu缓存：-cpu速度比内存快，内存比硬盘快" class="sidebar-link">CPU缓存： CPU速度比内存快，内存比硬盘快</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#二进制：" class="sidebar-link">二进制：</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#磁盘" class="sidebar-link">磁盘</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#国家" class="sidebar-link">国家</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#http-1-1" class="sidebar-link">http/1.1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#网络模型" class="sidebar-link">网络模型</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#ip协议" class="sidebar-link">IP协议</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#tcp协议" class="sidebar-link">TCP协议</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#tcp连接三次握手-四次挥手" class="sidebar-link">TCP连接三次握手,四次挥手</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#地址栏输入url过程" class="sidebar-link">地址栏输入URL过程</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#cdn" class="sidebar-link">CDN</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#dns协议" class="sidebar-link">DNS协议</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#uri" class="sidebar-link">URI</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#cookie" class="sidebar-link">cookie</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#if-modified-since" class="sidebar-link">If-Modified-since</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#get-post-put-head-delete-options" class="sidebar-link">get post put head delete options</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#keep-alive" class="sidebar-link">keep-alive</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#range" class="sidebar-link">Range</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#管线化" class="sidebar-link">管线化</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#状态码" class="sidebar-link">状态码</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#代理服务器-via" class="sidebar-link">代理服务器 Via</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#网关服务器-via" class="sidebar-link">网关服务器 Via</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#xmlhttprequest-express" class="sidebar-link">XMLHttpRequest + express</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#接口请求头-响应头" class="sidebar-link">接口请求头/响应头</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#index-html请求头-响应头" class="sidebar-link">index.html请求头/响应头</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#https" class="sidebar-link">HTTPS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#共享-对称-密钥加密" class="sidebar-link">共享(对称)密钥加密</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#公开-非对称-密钥加密" class="sidebar-link">公开(非对称)密钥加密</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#对称加密-rsa-中间人攻击" class="sidebar-link">对称加密 rsa 中间人攻击</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#ajax" class="sidebar-link">Ajax</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#websocket" class="sidebar-link">WebSocket</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#网络安全" class="sidebar-link">网络安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#xss" class="sidebar-link">xss</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#csp" class="sidebar-link">csp</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#csrf" class="sidebar-link">csrf</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#点击劫持" class="sidebar-link">点击劫持</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#其他" class="sidebar-link">其他</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#相关链接" class="sidebar-link">相关链接</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#问题" class="sidebar-link">问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#http2-0-3-0" class="sidebar-link">HTTP2.0 3.0</a></li></ul></li><li><a href="/js%E6%A6%82%E5%BF%B5.html#http-2" class="sidebar-link">HTTP/2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#http-2网站判断" class="sidebar-link">http/2网站判断</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#http-1瓶颈" class="sidebar-link">http/1瓶颈</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#http2优势" class="sidebar-link">http2优势</a></li><li class="sidebar-sub-header"><a href="/js%E6%A6%82%E5%BF%B5.html#升级为http2" class="sidebar-link">升级为http2</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="js概念"><a href="#js概念" class="header-anchor">#</a> js概念</h2> <h3 id="js单线程。"><a href="#js单线程。" class="header-anchor">#</a> JS单线程。</h3> <ol><li>JS同时只能执行一个JS任务。JS主要用于用户交互和操作DOM，如果多线程的话，一个线性在DOM上添加内容，一个线性删除内容，会麻烦</li> <li>浏览器或node环境是多线性，辅助js线程</li> <li>js引擎线程（主线程）运行js代码，遇到 setTimeout就把它交给浏览器的 定时器触发线程处理， ajax交给http异步线程处理， dom.onclick(fn()) 交给浏览器事件线程去执行</li> <li>主线程执行同步代码，遇到异步代码就交给浏览器异步线程，浏览器异步线程执行异步代码成功后，把回调函数丢进队列。 主线程执行完代码就去队列看一下，有没有回调函数要执行</li> <li>主线程、异步线程、消息队列，三者通过EventLoop事件循环来沟通</li></ol> <h3 id="网络通信，数据加密"><a href="#网络通信，数据加密" class="header-anchor">#</a> 网络通信，数据加密</h3> <p>对称加密（速度快）： 数据加密和解密用同一个密钥。双方一起保管。密钥传输麻烦</p> <p>非对称加密RSA:</p> <ol><li>双方有一对钥匙，一个私钥（保密的），一个公钥（公开的）。</li> <li>用私钥加密的数据，只有对应的公钥才能解密。</li> <li>用公钥加密的数据，只有对应的私钥才能解密。</li> <li>A给B发消息时，用B的公钥加密，B收到后，用B的私钥解密。</li> <li>把公钥和信息通过hash算法生成消息摘要，用CA(认证)私钥加密，生成数字签名，再把公钥和信息、数字签名合并成数字证书。</li> <li>CA证书会有操作系统/浏览器预置顶级CA证书来保证没被篡改</li></ol> <h3 id="https-就是用了ca证书"><a href="#https-就是用了ca证书" class="header-anchor">#</a> https 就是用了CA证书</h3> <ol><li>客户端发出请求</li> <li>服务器发送数字证书（公钥）给客户端</li> <li>浏览器用公钥加密请求数据</li> <li>服务器用私钥解密响应数据</li></ol> <h3 id="cpu缓存：-cpu速度比内存快，内存比硬盘快"><a href="#cpu缓存：-cpu速度比内存快，内存比硬盘快" class="header-anchor">#</a> CPU缓存： CPU速度比内存快，内存比硬盘快</h3> <h3 id="二进制："><a href="#二进制：" class="header-anchor">#</a> 二进制：</h3> <ol><li>计算机是没有减法的，当计算 1-1时，会转换成1+（-1），</li> <li>-1 ：1的值为 0000 0001， 再取反为  1111 1110 再加1，最终值为 1111 1111</li> <li>最后相加高位1溢出，直接忽略
<img src="/assets/img/1.9f3440ae.png" alt="1-1=0"></li></ol> <h3 id="磁盘"><a href="#磁盘" class="header-anchor">#</a> 磁盘</h3> <p>磁道是指同心圆区域</p> <p><img src="/assets/img/2.8e16f298.png" alt="磁盘"></p> <h2 id="国家"><a href="#国家" class="header-anchor">#</a> 国家</h2> <blockquote><p>印度</p></blockquote> <p>印度分离出了巴基斯坦，种族歧视，等级歧视，性别歧视。女性地位低</p> <blockquote><p>古巴比伦</p></blockquote> <p>古巴比伦就是伊拉克！被入侵，建立 新巴比伦王图，国王建立“空中花园”，地理位置特殊，夹在亚洲、欧洲、非洲中间，经常战乱。
后来成立了伊拉克，石油全球有名，萨达姆当政。打战抢邻国石油，最后引发2003年伊拉克战争，萨达姆被绞死，被恐怖组件ISIS统治</p> <blockquote><p>古埃及</p></blockquote> <p>埃及被亚历山大带希腊人干掉了。接下来被希腊人统计。金字塔是法老的坟墓。希腊人内乱，后又被罗马干掉，再被阿拉伯人统治，最后变成英国殖民地。现在穷！</p> <blockquote><p>希腊</p></blockquote> <p>希腊：宙斯。环境好。一堆小岛，各自称王。形成城邦国家。团结打败入侵的波斯，小兵报喜，创立了马拉松长跑。又内乱了。最后被亚历山大入侵统治，此时发展最好，有苏格拉底、柏拉图。被罗马征服，被土耳其剥削
最后独立。国家没钱，借钱还不起。四年一次的奥运会要去希腊取圣火。</p> <blockquote><p>罗马，西罗马变成意大利</p></blockquote> <p>凯撒大帝 扑克方块K, 屋大维时，罗马帝国几乎代表整个欧洲。后来分成东西罗马帝国。意大利属于西罗马帝国。意大利被匈奴入侵，被打败。意大利分列成小国。出现了基督教，社会大乱，黑暗的中世纪，持续1000年。然后达芬奇出现，文艺复兴，这让有钱人看到希望。此时意大利被其他国家统治。最后独立。一二战很垃圾。现在米兰有时装和模特。还有威尼斯水城。</p> <h2 id="http-1-1"><a href="#http-1-1" class="header-anchor">#</a> http/1.1</h2> <p>超文本传输协议： HTTP 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范</p> <p>超文本：包含文字、图片、视频等广义上的文本</p> <ol><li>明文传输不安全，HTTP 协议的实现本身非常简单，不论是谁发送过来的请求都会返回响应</li> <li>无法证明请求报文和响应报文的完整性，可能被篡改</li></ol> <p>http协议由请求头Request Header或响应头Respose Header,统称Header 和body(消息正文)组成，body非必须</p> <p>http默认端口80</p> <h3 id="网络模型"><a href="#网络模型" class="header-anchor">#</a> 网络模型</h3> <p>应用层：HTTP协议，SMTP(电子邮件传送协议)，FTP(文件上传协议)，DNS(域名解析协议)</p> <p>传输层：TCP协议、UDP协议</p> <p>网络层：IP协议(使用 <code>IP 地址</code> 来标识互联网上的每一台计算机)</p> <p>链路层：网络（以太网、WiFi）</p> <p>客户端在应用层（HTTP协议）发出一个想看<code>http://www.baidu.com</code> 页面的http请求,为了传输方便，在传输层(TCP协议)把接收到的数据(HTTP请求报文)进行分割处理，在网络层(IP协议)增加MAC地址后转发到链路层(网络) 。接收端的服务器在链路层接收到数据， -&gt; 网络层 -&gt; 传输层 -- 应用层，当传输到应用层，才算接收到客户端发送过来的http请求</p> <p>客户端： 应用层 http协议 --  传输层 TCP协议 -- 网络层 IP协议 ------&gt; 链路层 网络</p> <p>服务器： 链路层 网络 -- 网络层 IP协议 -- 传输层 TCP协议 -----&gt; 应用层http协议</p> <h3 id="ip协议"><a href="#ip协议" class="header-anchor">#</a> IP协议</h3> <p>把数据包传送给对方。利用IP地址和MAC地址</p> <h3 id="tcp协议"><a href="#tcp协议" class="header-anchor">#</a> TCP协议</h3> <p>为了更容易传送大数据才把数据分割，能够确认数据最终是否送达到对方。采用了三次握手策略</p> <h3 id="tcp连接三次握手-四次挥手"><a href="#tcp连接三次握手-四次挥手" class="header-anchor">#</a> TCP连接三次握手,四次挥手</h3> <p>建立TCP连接需要三次握手：</p> <ol><li>客户端向服务器发起连接请求，</li> <li>服务器收到后（确认客户端连接正常），向客户端发收到请求。</li> <li>客户端收到后（确认自己和服务器都连接正常）发确认连接请求（让服务器确认自己连接正常），建立连接。</li></ol> <p>关闭TCP连接需要四次挥手：</p> <ol><li>客户端发出关闭连接请求</li> <li>服务器发出是否关闭请求</li> <li>客户端发出确认关闭请求</li> <li>服务器发出已关闭信息。</li></ol> <p><img src="/assets/img/6.a44d97c6.jpg" alt="image-20200731181433669"></p> <h3 id="地址栏输入url过程"><a href="#地址栏输入url过程" class="header-anchor">#</a> 地址栏输入URL过程</h3> <ol><li>我们在地址栏输入URL（即网址，如<code>http://www.baidu.com</code>）</li> <li>DNS服务器会首先进行<strong>域名映射</strong>。找到对应的IP地址。</li> <li>http客户端建立起<strong>TCP连接</strong>。</li> <li>发送http<strong>请求报文</strong>，http服务器解析报文，获取数据封装到http<strong>响应报文</strong>，发给用户。</li> <li>客户接到响应报文后，<strong>断开TCP</strong>连接。</li> <li>HTTP客户端从响应报文提取出html响应文件。通过浏览器显示出来。</li></ol> <p><img src="/assets/img/7.0454bc62.jpg" alt="image-20200731181433669"></p> <h3 id="cdn"><a href="#cdn" class="header-anchor">#</a> CDN</h3> <p>是构建在现有网络基础之上的网络，它依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户<strong>就近</strong>获取所需内容 。  缓存、代理、分发等</p> <h3 id="dns协议"><a href="#dns协议" class="header-anchor">#</a> DNS协议</h3> <p>把 IP 地址转换为便于人类记忆的协议 ，DNS 协议提供通过域名查找 IP 地址，或逆向从 IP 地址反查域名的服务。</p> <h3 id="uri"><a href="#uri" class="header-anchor">#</a> URI</h3> <p>唯一地标记互联网上资源:  包含URL(网址)+URN(统一资源名称)</p> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h3> <p>http是不保存状态的协议，不对请求和响应之间的通信状态进行保存，为了保持用户的登陆状态，出现了cookie</p> <h3 id="if-modified-since"><a href="#if-modified-since" class="header-anchor">#</a> If-Modified-since</h3> <p>请求头出现 If-Modified-since: Thu, 12 Jul 2012 07:30:00 GMT 服务器会响应仅返回这个时间以后更新过的index.html页面资源，如果未有内容更新，则以304 Not Modified作为响应返回</p> <p>相关资料在6.4.9</p> <h3 id="get-post-put-head-delete-options"><a href="#get-post-put-head-delete-options" class="header-anchor">#</a> get post put head delete options</h3> <p>PUT 可传输文件，但http/1.1的put方法不带验证机制，任何人都可以上传文件，不安全，不使用</p> <p>delete删除文件，也不安全，不使用</p> <p>head 获得报文首部，用于确认 URI 的有效性及资源更新的日期时间等。少用</p> <p>options 查询针对请求URI指定的资源支持的方法（返回 Allow: get post,head等）</p> <p>这些都跟具体应用不太一样。。</p> <h3 id="keep-alive"><a href="#keep-alive" class="header-anchor">#</a> keep-alive</h3> <p>http1.1以前，当请求包含多张图片的html链接时</p> <ol><li>获取html文档：建立TCP连接，HTTP请求/响应，断开TCP连接</li> <li>获取图片1：建立TCP连接，HTTP请求/响应，断开TCP连接</li> <li>获取图片N: 建立TCP连接，HTTP请求/响应，断开TCP连接</li></ol> <p>会不断地建立TCP连接，每次的请求都会造成无谓的 TCP 连接建立和断开，增加通信量的开销。</p> <p>Connection:close  非持久连接，要求服务器发送完响应的对象后就关闭连接</p> <p>此时出现了持久连接 keep-alive 即保持TCP连接状态，一次性发完所有http请求/响应。</p> <p>在http/1.1中，所有连接默认都是持久连接  <code>Connection: keep-alive</code></p> <h3 id="range"><a href="#range" class="header-anchor">#</a> Range</h3> <p>响应头包含 Content-Range (请求一个10000字节的资源，断网后，使用范围请求，可以只请求剩余的5001~10000的部分数据)</p> <p>请求头 range:bytes=0-</p> <p>响应头 accept-ranges:bytes</p> <p>​			Content-Range: bytes 0-34343/343434</p> <p>ETag</p> <p>接口的response data 才有  6.5.3</p> <h3 id="管线化"><a href="#管线化" class="header-anchor">#</a> 管线化</h3> <p>持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。</p> <p>这样就能够做到同时并行发送多个请求，而不需要一个接一个地等待响应了。</p> <h3 id="状态码"><a href="#状态码" class="header-anchor">#</a> 状态码</h3> <p>204 请求成功，没资源可返回</p> <p>206 范围请求Range-Request</p> <p>401 未认证Unauthorized</p> <p>403 Forbidden 没权限</p> <p>500 Internal Server Error</p> <p>503 Service Unavailable(服务器处于超负载或停机维护)</p> <h3 id="代理服务器-via"><a href="#代理服务器-via" class="header-anchor">#</a> 代理服务器 Via</h3> <p>接收客户端发送的请求后转发给其他服务器。每次通过代理服务器转发请求或响应时，会追加写入 Via 首部信息。就是 响应头的 Via 。 利用缓存技术减少网络带宽的流量。包含<strong>缓存服务器</strong></p> <h3 id="网关服务器-via"><a href="#网关服务器-via" class="header-anchor">#</a> 网关服务器 Via</h3> <p>转发其他服务器通信数据，接收从客户端发送来的请求时，它就像自己拥有资源的源服务器一样对请求进行处理。有时客户端可能都不会察觉，自己的通信目标是一个网关。应用：购买用信息卡结算时，网关可以和信用卡结算系统联动。</p> <h2 id="xmlhttprequest-express"><a href="#xmlhttprequest-express" class="header-anchor">#</a> XMLHttpRequest + express</h2> <div class="language-html extra-class"><pre class="language-html"><code>// url:  http://localhost:8888/pcgomweb/1.html
<span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token comment">// 原生 + express</span>
  <span class="token keyword">function</span> <span class="token function">ajax</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token constant">URL</span><span class="token operator">=</span><span class="token string">'http://localhost:3000/'</span>
    <span class="token keyword">let</span> xmlhttp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xmlhttp<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlhttp<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xmlhttp<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 请求成功</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xmlhttp<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    xmlhttp<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span> <span class="token constant">URL</span><span class="token operator">+</span> <span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    xmlhttp<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/x-www-form-urlencoded&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设置请求头</span>
    xmlhttp<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;res=&quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    age<span class="token operator">:</span><span class="token number">31</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// node api.js</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 获取 post 请求参数    req.body</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 跨域</span>

<span class="token comment">// 添加json解析</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// get</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/a'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'aaa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/age'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// post</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/submit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span>age<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  arr<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'arr'</span><span class="token punctuation">,</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    result<span class="token operator">:</span> <span class="token string">'haha'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening on port 3000!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="接口请求头-响应头"><a href="#接口请求头-响应头" class="header-anchor">#</a> 接口请求头/响应头</h3> <p>请求头</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">Accept:</span> */*
<span class="token header-name keyword">Accept-Encoding:</span> gzip, deflate, br
<span class="token header-name keyword">Accept-Language:</span> zh-CN,zh;q=0.9
<span class="token header-name keyword">Cache-Control:</span> no-cache   // 默认不缓存
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Content-Length:</span> 14
<span class="token header-name keyword">Content-type:</span> application/x-www-form-urlencoded  // 这个是设置的，其他都是默认的
<span class="token header-name keyword">Host:</span> localhost:3000   // api服务器域名
<span class="token header-name keyword">Origin:</span> http://localhost:8888  // 本地服务器域名
<span class="token header-name keyword">Pragma:</span> no-cache
<span class="token header-name keyword">Referer:</span> http://localhost:8888/pcgomweb/1.html  //  当前链接
<span class="token header-name keyword">Sec-Fetch-Dest:</span> empty
<span class="token header-name keyword">Sec-Fetch-Mode:</span> cors
<span class="token header-name keyword">Sec-Fetch-Site:</span> same-site
<span class="token header-name keyword">User-Agent:</span> Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
</code></pre></div><p>响应头</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">Access-Control-Allow-Origin:</span> *    // 这个是设置的，其他都是默认的
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Content-Length:</span> 17
<span class="token header-name keyword">Content-Type:</span> application/json; charset=utf-8   // 这个是设置的 res.json()
<span class="token header-name keyword">Date:</span> Wed, 26 Aug 2020 03:06:42 GMT
<span class="token header-name keyword">ETag:</span> W/&quot;11-AUjVioKC+y0tfWxgttKaPngTxTA&quot;
<span class="token header-name keyword">X-Powered-By:</span> Express         // 框架
</code></pre></div><h3 id="index-html请求头-响应头"><a href="#index-html请求头-响应头" class="header-anchor">#</a> index.html请求头/响应头</h3> <p>请求头</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">Accept:</span> text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9    // q是权重 0~1
<span class="token header-name keyword">Accept-Encoding:</span> gzip, deflate, br
<span class="token header-name keyword">Accept-Language:</span> zh-CN,zh;q=0.9
<span class="token header-name keyword">Cache-Control:</span> no-cache    // 默认不缓存
<span class="token header-name keyword">Connection:</span> keep-alive
<span class="token header-name keyword">Cookie:</span> Hm_lvt_3c187470b692e2d95f347970c5f35210=1597384818
<span class="token header-name keyword">Host:</span> localhost:8888
<span class="token header-name keyword">Pragma:</span> no-cache   // HTTP/1.1 之前版本的历史遗留字段，仅作为与 HTTP/1.0 的向后兼容而定义。没啥用
<span class="token header-name keyword">Sec-Fetch-Dest:</span> document
<span class="token header-name keyword">Sec-Fetch-Mode:</span> navigate
<span class="token header-name keyword">Sec-Fetch-Site:</span> none
<span class="token header-name keyword">Sec-Fetch-User:</span> ?1
<span class="token header-name keyword">Upgrade-Insecure-Requests:</span> 1
<span class="token header-name keyword">User-Agent:</span> Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36
</code></pre></div><p>index.html响应头</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">cache-control:</span> private, must-revalidate
<span class="token header-name keyword">content-length:</span> 680
<span class="token header-name keyword">content-type:</span> text/html
<span class="token header-name keyword">date:</span> Wed, 26 Aug 2020 03:36:16 GMT
<span class="token header-name keyword">last-modified:</span> Wed, 26 Aug 2020 03:11:06 GMT
<span class="token header-name keyword">server:</span> WebStorm 2018.3.5
<span class="token header-name keyword">X-Content-Type-Options:</span> nosniff
<span class="token header-name keyword">X-Frame-Options:</span> SameOrigin   // 防止点击劫持攻击  SameOrigin同源域名   6.8.1
<span class="token header-name keyword">x-xss-protection:</span> 1; mode=block  // 跨站脚本攻击XSS  1有效  0 无效
</code></pre></div><p>css、js文件请求头基本跟html一样</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">Accept:</span> text/css,*/*;q=0.1  // css
<span class="token header-name keyword">Accept:</span> */*  // js 
<span class="token header-name keyword">Referer:</span> http://localhost:8888/pcgomweb/1.html?_ijt=949tra7ie563giij14nna8itnh
</code></pre></div><p>response headers</p> <div class="language-http extra-class"><pre class="language-http"><code><span class="token header-name keyword">content-type:</span> text/css                 // css
<span class="token header-name keyword">content-type:</span> application/javascript   // js
</code></pre></div><h2 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h2> <p>超文本传输安全协议（http secure)</p> <p>在HTTP 的基础上增加了 <code>SSL</code> 层（公开密钥加密方式），添加了加密及认证机制，就是HTTPS</p> <p>https默认端口443</p> <p>https比http要慢2~100倍，SSL通信慢、加密耗时。因此，非敏感信息用http通信，包含个人信息等敏感数据用https加密通信。https还需要购买证书，一年600元左右</p> <h3 id="共享-对称-密钥加密"><a href="#共享-对称-密钥加密" class="header-anchor">#</a> 共享(对称)密钥加密</h3> <p>客户和服务器用<strong>同一个密钥</strong>来加密解密</p> <h3 id="公开-非对称-密钥加密"><a href="#公开-非对称-密钥加密" class="header-anchor">#</a> 公开(非对称)密钥加密</h3> <p>使用<strong>一对</strong>非对称的密钥。发送密文的一方<strong>使用对方的公开密钥</strong>进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。</p> <p><strong>HTTPS 采用两者混合加密机制</strong></p> <p>公开密钥加密太复杂，于是用来<strong>加密共享密钥</strong>，确保密钥安全后，使用<strong>这个密钥</strong>进行共享密钥加密通信。</p> <p>使用CA等认证机构发布的公开密钥证书证明公开密钥的正确性。这些证书内置于浏览器中。</p> <p><img src="/assets/img/8.d1364ae7.jpg" alt="image-20200731181433669"></p> <h3 id="对称加密-rsa-中间人攻击"><a href="#对称加密-rsa-中间人攻击" class="header-anchor">#</a> 对称加密 rsa 中间人攻击</h3> <div class="language- extra-class"><pre class="language-text"><code>对称加密： 公用一个密钥 key来加密解密数据， 这个密钥无法传输

rsa非对称加密：  双方各有一对私钥和公钥， 用a的公钥加密，a收到数据时，用自己的私钥解密。   问题：rsa慢。

两者结合： 用rsa传递对称加密密钥key, 传完用key来加密解密数据。

中间人攻击： a发公钥给b时，被中间人换了，b以为是a的公钥，就用它加密了。发回给a时，又被中间人截取了，还能解密。信息就泄露了。

https://juejin.cn/post/6844903718182354951
</code></pre></div><p>第7章</p> <h3 id="ajax"><a href="#ajax" class="header-anchor">#</a> Ajax</h3> <p>社区论坛要实时显示用户提交的数据，传统http需要频繁地从客户端到服务器进行确认是否有新数据（http瓶颈），利用Ajax 和dom 来请求服务器，更新部分页面</p> <h3 id="websocket"><a href="#websocket" class="header-anchor">#</a> WebSocket</h3> <p>长连接 替代验证票的定时器</p> <p>建立在http基础上，解决http瓶颈。一旦客户端和服务器建立WebSocket连接，两者可直接向对方发送报文、推送数据。WebSocket连接一直保持连接状态。</p> <p>建立连接 请求头 <code>upgrade:websocket</code> 响应头 <code>101 Switching Protocols</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://xxx'</span><span class="token punctuation">)</span>
sock<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>数据<span class="token punctuation">)</span>   <span class="token comment">// 提交数据   </span>
sock<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">//接收数据    客户端和服务器都有这两个方法</span>
前端  ： https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>socketio<span class="token operator">/</span>socket<span class="token punctuation">.</span>io<span class="token operator">-</span>client
</code></pre></div><h2 id="网络安全"><a href="#网络安全" class="header-anchor">#</a> 网络安全</h2> <h3 id="xss"><a href="#xss" class="header-anchor">#</a> xss</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
* xss 攻击预防
* 目前地址栏的xss : http://xxx.html?name=&lt;script&gt;alert(1)&lt;/script&gt;
* 输入框，图片，富文本
* chrome 会自己转义
* */</span>

<span class="token comment">// 转义 &lt; &gt; &quot; '  空格不转义</span>
<span class="token keyword">function</span> <span class="token function">escapeHtml</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token comment">// 地址栏的xss已经先被chrome 转义了，这代码无效了</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&amp;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;amp;'</span><span class="token punctuation">)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;lt;'</span><span class="token punctuation">)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&gt;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;gt;'</span><span class="token punctuation">)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&quot;/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;quto;'</span><span class="token punctuation">)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/'/g</span><span class="token punctuation">,</span> <span class="token string">'&amp;#39;'</span><span class="token punctuation">)</span> <span class="token comment">// html实体</span>
  <span class="token keyword">return</span> str
<span class="token punctuation">}</span>
<span class="token comment">// js 转义</span>
<span class="token comment">// 地址栏的xss已经先被chrome 转义了，这代码无效了</span>
<span class="token comment">// let url = JSON.stringify(xx),</span>

<span class="token comment">/*
* 富文本xss 过滤
* 黑名单过滤
* 白名单允许
* 插件 npm i xss
* */</span>
<span class="token comment">// 富文本过滤</span>
<span class="token keyword">function</span> <span class="token function">filter</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token comment">// 黑名单过滤太多太麻烦</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;\s*\/?script\s*&gt;/g</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 过滤 &lt;script&gt;</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/javascript:[^'&quot;]*/g</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 过滤 javascript:alert(1)</span>
  str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/onerror\s*=\s*['&quot;]?[^'&quot;]*['&quot;]?/g</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 过滤 onerror</span>

  <span class="token keyword">return</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// cheerio 解析html, 语法类似 jq</span>
<span class="token keyword">function</span> <span class="token function">filter2</span> <span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>html<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> cheerio <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cheerio'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 引入 cheerio</span>
  <span class="token keyword">var</span> $ <span class="token operator">=</span> cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>
  <span class="token comment">// 白名单</span>
  <span class="token keyword">var</span> whiteList <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'img'</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'font'</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'color'</span><span class="token punctuation">,</span><span class="token string">'size'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'a'</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> elem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>whiteList<span class="token punctuation">[</span>elem<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 清空白名单不存在的标签</span>
      <span class="token function">$</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> attr <span class="token keyword">in</span> elem<span class="token punctuation">.</span>attribs<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>whiteList<span class="token punctuation">[</span>elem<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token operator">===</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">$</span><span class="token punctuation">(</span>elem<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span>attr<span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// 清空白名单不存在属性</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// npm i xss  使用第三方库解决白名单</span>
</code></pre></div><h3 id="csp"><a href="#csp" class="header-anchor">#</a> csp</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
* csp  内容安全策略，用于指定哪些内容可执行
* 预防xss 攻击
*
*  &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;default-src 'self'; img-src https://*; child-src 'none';&quot;&gt;
*    详见 https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP
* */</span>


<span class="token comment">// nodejs 防xss</span>
<span class="token comment">// ctx.set('X-XSS-Protection',1);  // 0是关闭 1是打开防御  功能不全面</span>
<span class="token comment">//</span>
<span class="token comment">// ctx.set(`Content-Security-Policy`,`default-src 'self'`)  //csp内容安全策略</span>
</code></pre></div><h3 id="csrf"><a href="#csrf" class="header-anchor">#</a> csrf</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
*  CSRF： 第三方网站不用访问你的网站，就拿到你的信息，并调用你的接口乱来
*
*  打开某网站A，自己的账号信息保存在cookie中被获取，导致自己银行卡的钱丢了
*  1.设置cookie只能本网站访问
*   cookie.set(sameSite = Strict)
*
*  2.加图形验证码/TOKEN等，必须经过本网站，防CSRF
*  nodejs npm i ccap 生成图形验证码
*
*  3.加 token ，必须经过本网站，防CSRF，  token的用户体验比图形验证码好
*
*  4. referer 不是很好，有些访问没有referer
*  验证referer值 禁止来自第三方网站的请求
*  // nodejs
*  var referer = ctx.reques.headers.referer;
*  if(!/^https?:\/\/localhost/.test(referer)){
*     console.log('error')
*  }
* */</span>
</code></pre></div><h3 id="点击劫持"><a href="#点击劫持" class="header-anchor">#</a> 点击劫持</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
*  点击劫持：原理：自己的网站被第三方用Iframe内嵌，
 *  自己点击跳出来的网站后，发现自己的钱没了。
*  垃圾邮件点击劫持
*  本网站禁止内嵌，防止点击劫持
*  nodejs  ctx.set('X-Frame-Options','DENY');  禁止页面内嵌  兼容ie8
* */</span>
<span class="token comment">// 如果有iframe嵌入的话，两者值不一致，一刷新假页面，页面会跳转到真正的页面</span>
<span class="token comment">// 如果被禁止js 则以下代码无效了</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>top<span class="token punctuation">.</span>location <span class="token operator">!==</span>window<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">{</span>
  top<span class="token punctuation">.</span>location <span class="token operator">=</span> window<span class="token punctuation">.</span>location
<span class="token punctuation">}</span>

<span class="token comment">// &lt;iframe sandbox = '' &gt;  iframe 的sandbox 可以禁用 js 等一堆功能</span>
</code></pre></div><h3 id="其他"><a href="#其他" class="header-anchor">#</a> 其他</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// http协议 窃听，篡cuan改</span>
<span class="token comment">//    生成ca证书，放入项目中，引用ca证书，使用https来访问，proxy代理抓包则看不到任何请求数据</span>

<span class="token comment">/*
* 密码 md5等加密  mysql 注入  文件上传漏洞(后端文件内容检查、用nginx读取文件再返回、控制读写权限等，nodejs问题不大)
* */</span>
<span class="token comment">// 防止盗QQ，盗身份证进信息等   OAuth 引入  使用QQ登陆某网站，使用了用户授权</span>

<span class="token comment">// cdn 加速 防dns攻击 https加密  token 时间戳， 签名</span>
</code></pre></div><h2 id="相关链接"><a href="#相关链接" class="header-anchor">#</a> 相关链接</h2> <p><a href="https://juejin.im/post/6844904045572800525#heading-12" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://segmentfault.com/a/1190000023731992" target="_blank" rel="noopener noreferrer">文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>书籍： 图解http</p> <p>书籍：http/2基础教程  2018.1</p> <h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <h3 id="http2-0-3-0"><a href="#http2-0-3-0" class="header-anchor">#</a> HTTP2.0 3.0</h3> <p>非对称加密</p> <p>chrome开发者工具</p> <h2 id="http-2"><a href="#http-2" class="header-anchor">#</a> HTTP/2</h2> <p>简称h2，书《http/2基础教程》看不懂。</p> <h3 id="http-2网站判断"><a href="#http-2网站判断" class="header-anchor">#</a> http/2网站判断</h3> <ol><li><a href="https://www.dute.org/http2" target="_blank" rel="noopener noreferrer">http/2 检测工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>   链接必须带上https</li> <li>chrome 如果响应头有 view source 点进去就可以查看http版本，如果没有view source，说明是http2, 因为http2是采用二进制传输</li> <li>chrome network 右键勾选 protocol</li></ol> <p>https://m.caijiyouxi.com/m/alpha/rescuePlan/index.html  支持http/2.0</p> <p>百度首页居然是http/1.1</p> <p>延迟 带宽 DNS查询 建立连接时间 TLS协商时间 首字节时间（TTFB)  内容下载时间 开始渲染时间 文档加载完成时间 更多的字节 更多的资源 更高的复杂度 更多的域名 更多的TCP socket</p> <h3 id="http-1瓶颈"><a href="#http-1瓶颈" class="header-anchor">#</a> http/1瓶颈</h3> <p>队头阻塞： http/1 的管道化允许一次发送一组请求，但只能按照发送顺序依次接收响应，如果某个资源出现问题，剩下所有的工作都会被阻塞在那次请求应答之后。会阻碍网络传输和 Web 页面渲染，直至失去响应</p> <p>低效的TCP利用：</p> <div class="language-html extra-class"><pre class="language-html"><code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//ajax.googleapis.com&gt;
</code></pre></div><p><strong>HTTP/1优化技巧，以及HTTP/2的相关建议</strong></p> <table><thead><tr><th style="text-align:left;">名称</th> <th style="text-align:left;">描述</th> <th style="text-align:left;">备注</th></tr></thead> <tbody><tr><td style="text-align:left;">资源合并</td> <td style="text-align:left;">把多个文件（javascript、css）合成一个文件，以减少 http 请求</td> <td style="text-align:left;">在 http/2 下这并非必要，因为请求的传输字节数和时间成本更低，虽然这种成本仍然存在</td></tr> <tr><td style="text-align:left;">极简化</td> <td style="text-align:left;">去除 html、javascript、css 这类文件中无用的代码</td> <td style="text-align:left;">很棒的做法，在 http/2 下也要保留</td></tr> <tr><td style="text-align:left;">域名拆分</td> <td style="text-align:left;">把资源分布到不同的域名上面去，让浏览器利用更多的 socket 连接</td> <td style="text-align:left;">http/2 的设计意图是充分利用单个 socket 连接，而拆分域名会违背这种意图。建议取消域名拆分，但请注意本表格之后的附注框会介绍这个问题相关的各种复杂情况</td></tr> <tr><td style="text-align:left;">禁用 cookie 的域名</td> <td style="text-align:left;">为图片之类的资源建立单独的域名，这些域名不用 cookie，以尽可能减少请求尺寸</td> <td style="text-align:left;">应该避免为这些资源单独设立域名（参见“域名拆分”），但更重要的是，由于 http/2 提供了首部压缩，cookie 的开销会显著降低</td></tr> <tr><td style="text-align:left;">生成精灵图</td> <td style="text-align:left;">把多张图片拼合为一个文件，使用 css 控制在 web 页面上展示的部分</td> <td style="text-align:left;">与极简化类似，只不过用 css 实现这种效果的代价高昂；不推荐在 http/2 中使用</td></tr></tbody></table> <p>tengine</p> <p>淘宝的web服务器，在nginx的基础上，针对大访问量网站的<a href="https://baike.baidu.com/item/%E9%9C%80%E6%B1%82/3543925" target="_blank" rel="noopener noreferrer">需求<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，添加了很多高级功能和特性</p> <h3 id="http2优势"><a href="#http2优势" class="header-anchor">#</a> http2优势</h3> <ol><li>二进制分帧层，http1是明文传输</li> <li>多路复用，同一域名只创建一个连接，实现多请求-响应并行，解决了线头阻塞的问题，减少了 TCP 连接数量和 TCP 连接慢启动造成的问题</li> <li>服务器推送</li> <li>Header 压缩</li></ol> <p><a href="https://blog.fundebug.com/2019/03/07/understand-http2-and-http3/" target="_blank" rel="noopener noreferrer">一文读懂 HTTP/2 及 HTTP/3 特性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="升级为http2"><a href="#升级为http2" class="header-anchor">#</a> 升级为http2</h3> <div class="language-nginx extra-class"><pre class="language-nginx"><code><span class="token comment"># 版本必须大于 1.9.x 查版本命令 nginx -v</span>
<span class="token comment"># /etc/nginx/nginx.conf </span>
<span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token comment"># 重点就是这里加http2</span>
    <span class="token keyword">listen</span>    <span class="token number">443</span>  <span class="token keyword">ssl</span> http2 default_server<span class="token punctuation">;</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6f322a7c.js" defer></script><script src="/assets/js/2.5281df64.js" defer></script><script src="/assets/js/4.eb70c47d.js" defer></script>
  </body>
</html>
