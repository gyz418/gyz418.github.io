<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>nodejs | gyz418</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.7c4bcbe6.css" as="style"><link rel="preload" href="/assets/js/app.6f322a7c.js" as="script"><link rel="preload" href="/assets/js/2.5281df64.js" as="script"><link rel="preload" href="/assets/js/8.78f8209a.js" as="script"><link rel="prefetch" href="/assets/js/10.b5b78ec7.js"><link rel="prefetch" href="/assets/js/11.3979c63f.js"><link rel="prefetch" href="/assets/js/12.ad66bd03.js"><link rel="prefetch" href="/assets/js/13.8c156ce0.js"><link rel="prefetch" href="/assets/js/14.d5aaf7c9.js"><link rel="prefetch" href="/assets/js/15.744185ba.js"><link rel="prefetch" href="/assets/js/16.b223ec11.js"><link rel="prefetch" href="/assets/js/17.27940440.js"><link rel="prefetch" href="/assets/js/18.2561b5d6.js"><link rel="prefetch" href="/assets/js/19.bab52827.js"><link rel="prefetch" href="/assets/js/20.64459c18.js"><link rel="prefetch" href="/assets/js/21.95850c08.js"><link rel="prefetch" href="/assets/js/22.8b92906a.js"><link rel="prefetch" href="/assets/js/23.a2fee047.js"><link rel="prefetch" href="/assets/js/24.a1a3b298.js"><link rel="prefetch" href="/assets/js/25.ba19b2b6.js"><link rel="prefetch" href="/assets/js/26.753266fe.js"><link rel="prefetch" href="/assets/js/27.ee58b5d1.js"><link rel="prefetch" href="/assets/js/28.611ffe65.js"><link rel="prefetch" href="/assets/js/29.d446cc43.js"><link rel="prefetch" href="/assets/js/3.d5898f06.js"><link rel="prefetch" href="/assets/js/30.71c0d378.js"><link rel="prefetch" href="/assets/js/31.43e00d33.js"><link rel="prefetch" href="/assets/js/32.a6757d5d.js"><link rel="prefetch" href="/assets/js/33.bfb83c0e.js"><link rel="prefetch" href="/assets/js/34.564690e0.js"><link rel="prefetch" href="/assets/js/35.77a7c9e4.js"><link rel="prefetch" href="/assets/js/36.5e974fda.js"><link rel="prefetch" href="/assets/js/37.f0956a85.js"><link rel="prefetch" href="/assets/js/38.c42b9666.js"><link rel="prefetch" href="/assets/js/39.7262da55.js"><link rel="prefetch" href="/assets/js/4.eb70c47d.js"><link rel="prefetch" href="/assets/js/40.95d088a9.js"><link rel="prefetch" href="/assets/js/41.f7067891.js"><link rel="prefetch" href="/assets/js/42.12cf6162.js"><link rel="prefetch" href="/assets/js/43.7970973b.js"><link rel="prefetch" href="/assets/js/44.701b85aa.js"><link rel="prefetch" href="/assets/js/45.4c06d258.js"><link rel="prefetch" href="/assets/js/46.e5e18c20.js"><link rel="prefetch" href="/assets/js/47.5d0f9322.js"><link rel="prefetch" href="/assets/js/48.03ad2213.js"><link rel="prefetch" href="/assets/js/49.65826398.js"><link rel="prefetch" href="/assets/js/5.8e0377fa.js"><link rel="prefetch" href="/assets/js/50.8a4a5a58.js"><link rel="prefetch" href="/assets/js/6.49592538.js"><link rel="prefetch" href="/assets/js/7.c7371c19.js"><link rel="prefetch" href="/assets/js/9.823e0afe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7c4bcbe6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">gyz418</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/前端/ts.html" class="nav-link">
  ts
</a></li><li class="dropdown-item"><!----> <a href="/前端/flutter.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/前端/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/前端/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/前端/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/前端/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/前端/js优化.html" class="nav-link">
  js优化
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue2源码.html" class="nav-link">
  vue2源码
</a></li><li class="dropdown-item"><!----> <a href="/前端/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue3.html" class="nav-link">
  vue3
</a></li><li class="dropdown-item"><!----> <a href="/前端/js设计模式.html" class="nav-link">
  js设计模式
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/前端/package.json.html" class="nav-link">
  package.json
</a></li><li class="dropdown-item"><!----> <a href="/前端/github.html" class="nav-link">
  github
</a></li><li class="dropdown-item"><!----> <a href="/前端/eslint.html" class="nav-link">
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/前端/nestjs.html" class="nav-link">
  nestjs
</a></li><li class="dropdown-item"><!----> <a href="/前端/ueditor.html" class="nav-link">
  ueditor
</a></li><li class="dropdown-item"><!----> <a href="/typescript.html" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gulp.html" class="nav-link">
  gulp
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/js-tools.html" class="nav-link">
  js-tools
</a></li><li class="dropdown-item"><!----> <a href="/js特效.html" class="nav-link">
  js特效
</a></li><li class="dropdown-item"><!----> <a href="/old.html" class="nav-link">
  old
</a></li><li class="dropdown-item"><!----> <a href="/js概念.html" class="nav-link">
  js概念
</a></li><li class="dropdown-item"><!----> <a href="/jest.html" class="nav-link">
  jest
</a></li><li class="dropdown-item"><!----> <a href="/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/service worker.html" class="nav-link">
  service worker
</a></li><li class="dropdown-item"><!----> <a href="/deno.html" class="nav-link">
  deno
</a></li><li class="dropdown-item"><!----> <a href="/swiper.html" class="nav-link">
  swiper
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/chrome.html" class="nav-link">
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/webstorm.html" class="nav-link">
  webstorm
</a></li><li class="dropdown-item"><!----> <a href="/url.html" class="nav-link">
  url
</a></li><li class="dropdown-item"><!----> <a href="/pc.html" class="nav-link">
  pc
</a></li><li class="dropdown-item"><!----> <a href="/festival.html" class="nav-link">
  festival
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端/es6.html" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue.html" class="nav-link">
  vue
</a></li><li class="dropdown-item"><!----> <a href="/前端/ts.html" class="nav-link">
  ts
</a></li><li class="dropdown-item"><!----> <a href="/前端/flutter.html" class="nav-link">
  flutter
</a></li><li class="dropdown-item"><!----> <a href="/前端/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/前端/git.html" class="nav-link">
  git
</a></li><li class="dropdown-item"><!----> <a href="/前端/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/前端/nodejs.html" class="nav-link">
  nodejs
</a></li><li class="dropdown-item"><!----> <a href="/前端/js优化.html" class="nav-link">
  js优化
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue2源码.html" class="nav-link">
  vue2源码
</a></li><li class="dropdown-item"><!----> <a href="/前端/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/前端/vue3.html" class="nav-link">
  vue3
</a></li><li class="dropdown-item"><!----> <a href="/前端/js设计模式.html" class="nav-link">
  js设计模式
</a></li><li class="dropdown-item"><!----> <a href="/前端/小程序.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/前端/package.json.html" class="nav-link">
  package.json
</a></li><li class="dropdown-item"><!----> <a href="/前端/github.html" class="nav-link">
  github
</a></li><li class="dropdown-item"><!----> <a href="/前端/eslint.html" class="nav-link">
  eslint
</a></li><li class="dropdown-item"><!----> <a href="/前端/nestjs.html" class="nav-link">
  nestjs
</a></li><li class="dropdown-item"><!----> <a href="/前端/ueditor.html" class="nav-link">
  ueditor
</a></li><li class="dropdown-item"><!----> <a href="/typescript.html" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端相关" class="dropdown-title"><span class="title">前端相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gulp.html" class="nav-link">
  gulp
</a></li><li class="dropdown-item"><!----> <a href="/react.html" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/js-tools.html" class="nav-link">
  js-tools
</a></li><li class="dropdown-item"><!----> <a href="/js特效.html" class="nav-link">
  js特效
</a></li><li class="dropdown-item"><!----> <a href="/old.html" class="nav-link">
  old
</a></li><li class="dropdown-item"><!----> <a href="/js概念.html" class="nav-link">
  js概念
</a></li><li class="dropdown-item"><!----> <a href="/jest.html" class="nav-link">
  jest
</a></li><li class="dropdown-item"><!----> <a href="/微前端.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/service worker.html" class="nav-link">
  service worker
</a></li><li class="dropdown-item"><!----> <a href="/deno.html" class="nav-link">
  deno
</a></li><li class="dropdown-item"><!----> <a href="/swiper.html" class="nav-link">
  swiper
</a></li><li class="dropdown-item"><!----> <a href="/nginx.html" class="nav-link">
  nginx
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/chrome.html" class="nav-link">
  chrome
</a></li><li class="dropdown-item"><!----> <a href="/vscode.html" class="nav-link">
  vscode
</a></li><li class="dropdown-item"><!----> <a href="/webstorm.html" class="nav-link">
  webstorm
</a></li><li class="dropdown-item"><!----> <a href="/url.html" class="nav-link">
  url
</a></li><li class="dropdown-item"><!----> <a href="/pc.html" class="nav-link">
  pc
</a></li><li class="dropdown-item"><!----> <a href="/festival.html" class="nav-link">
  festival
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>nodejs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#nodejs" class="sidebar-link">nodejs</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#win7安装高版本nodejs" class="sidebar-link">win7安装高版本nodejs</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#vuepress升级nodejs版本" class="sidebar-link">vuepress升级nodejs版本</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#pnpm" class="sidebar-link">pnpm</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#commonjs循环引用" class="sidebar-link">commonjs循环引用</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#es-module循环引用" class="sidebar-link">es module循环引用</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#rollup" class="sidebar-link">rollup</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#nvm" class="sidebar-link">nvm</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#nodejs版本" class="sidebar-link">nodejs版本</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#nodejs-cache-control" class="sidebar-link">nodejs Cache-Control</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npm包" class="sidebar-link">npm包</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#events事件监听" class="sidebar-link">events事件监听</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#unil-promisify" class="sidebar-link">unil.promisify</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#linux配置" class="sidebar-link">linux配置</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#nodejs执行打包" class="sidebar-link">nodejs执行打包</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#pnpm-2" class="sidebar-link">pnpm</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#重命名" class="sidebar-link">重命名</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#package-json-版本号" class="sidebar-link">package.json 版本号</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#指定node环境执行" class="sidebar-link">指定node环境执行</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#modules-exports-exports" class="sidebar-link">modules.exports  exports</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#require" class="sidebar-link">require</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#获取命令行参数" class="sidebar-link">获取命令行参数</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#path-resolve" class="sidebar-link">path.resolve()</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#process-cwd-路径问题" class="sidebar-link">process.cwd() 路径问题</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#process" class="sidebar-link">process</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#require传参数" class="sidebar-link">require传参数</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#promptmoduleapi-给类注入数据" class="sidebar-link">PromptModuleAPI 给类注入数据</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#批量导出导入文件" class="sidebar-link">批量导出导入文件</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#writefile" class="sidebar-link">writeFile</a></li></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#api" class="sidebar-link">api</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#chalk-控制台颜色" class="sidebar-link">chalk 控制台颜色</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#commander-命令行" class="sidebar-link">commander 命令行</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#inquirer-交互命令行" class="sidebar-link">inquirer 交互命令行</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#execa-执行命令" class="sidebar-link">execa 执行命令</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#progress-进度条" class="sidebar-link">progress 进度条</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#minimist-命令行简单版" class="sidebar-link">minimist  命令行简单版</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#get-port-端口" class="sidebar-link">get-port 端口</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#other" class="sidebar-link">other</a></li></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npm发包" class="sidebar-link">npm发包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npm全局地址" class="sidebar-link">npm全局地址</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npm包兼容全局库，默认es-module可用" class="sidebar-link">npm包兼容全局库，默认es module可用</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#shelljs" class="sidebar-link">shelljs</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#mddir" class="sidebar-link">mddir</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#path" class="sidebar-link">path</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#new" class="sidebar-link">new</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npm包安装不了" class="sidebar-link">npm包安装不了</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#node-sass" class="sidebar-link">node-sass</a></li></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#mongodb" class="sidebar-link">mongodb</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#npx" class="sidebar-link">npx</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#快速服务器" class="sidebar-link">快速服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#serve" class="sidebar-link">serve</a></li><li class="sidebar-sub-header"><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#http-server" class="sidebar-link">http-server</a></li></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#eslint" class="sidebar-link">eslint</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E5%89%8D%E7%AB%AF/nodejs.html#markdown" class="sidebar-link">markdown</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="nodejs"><a href="#nodejs" class="header-anchor">#</a> nodejs</h2> <h3 id="win7安装高版本nodejs"><a href="#win7安装高版本nodejs" class="header-anchor">#</a> win7安装高版本nodejs</h3> <div class="language- extra-class"><pre class="language-text"><code>直接覆盖
https://www.phpvar.com/archives/4925.html
添加到环境变量
https://blog.csdn.net/monsterjiju/article/details/124640505

系统变量
变量名：NODE_SKIP_PLATFORM_CHECK
变量值：1

https://nodejs.org/download/release/v18.12.0/
Vite 需要 Node.js 版本 14.18+，16+。
pnpm 需要 Node.js 版本 16.14
win7最高支持的nodejs版本是v13.14.0
</code></pre></div><h3 id="vuepress升级nodejs版本"><a href="#vuepress升级nodejs版本" class="header-anchor">#</a> vuepress升级nodejs版本</h3> <div class="language- extra-class"><pre class="language-text"><code> &quot;dev&quot;: &quot;set NODE_OPTIONS=--openssl-legacy-provider &amp; vuepress dev docs&quot;,
 &quot;prod&quot;: &quot;set NODE_OPTIONS=--openssl-legacy-provider &amp; vuepress build docs&quot;
</code></pre></div><p>where node</p> <div class="language- extra-class"><pre class="language-text"><code>查看node安装目录
</code></pre></div><h3 id="pnpm"><a href="#pnpm" class="header-anchor">#</a> pnpm</h3> <div class="language-js extra-class"><pre class="language-js"><code>npm i <span class="token operator">-</span>g pnpm  <span class="token comment">// 7.27.1</span>
</code></pre></div><h3 id="commonjs循环引用"><a href="#commonjs循环引用" class="header-anchor">#</a> commonjs循环引用</h3> <div class="language- extra-class"><pre class="language-text"><code>console.log(require)
webstorm打个断点，debug一下，有个require函数，里面有cache对象，把当前index.js和 require('./a') a.js都缓存起来了，当代码循环引用时， a.js引入b.js b.js引入a.js ，由于有缓存，代码不会重新加载，直接在缓存中读取，解决循环引用的问题
</code></pre></div><p><img src="/assets/img/13.2582eb29.png" alt="image-20200731181433669"></p> <p>第三方模块node_module路径,  从当前目录依次找node_modules，递归往上一层目录查找</p> <p><img src="/assets/img/14.ec875f14.png" alt="image-20200731181433669"></p> <h3 id="es-module循环引用"><a href="#es-module循环引用" class="header-anchor">#</a> es module循环引用</h3> <div class="language- extra-class"><pre class="language-text"><code>es module循环引用也正常， a.js 引入b.js 标记a模块、标记b杠杆  b.js又引入a.js 此时a.js已有标记，不会再进入a.js跳过，继续执行b.js其他代码
</code></pre></div><p>index.mjs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">'./a.mjs'</span>    <span class="token comment">// 标记a.mjs</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'index.mjs'</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>a.mjs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> b <span class="token keyword">from</span> <span class="token string">&quot;./b.mjs&quot;</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">&quot;原始值-a模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a模块引用b模块：&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token string">&quot;修改值-a模块内变量&quot;</span>
</code></pre></div><p>b.mjs</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> a <span class="token keyword">from</span> <span class="token string">&quot;./a.mjs&quot;</span>   <span class="token comment">// a.mjs已标记，不会再进入a.mjs 继续执行下面的代码</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">&quot;原始值-b模块内变量&quot;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> b <span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;b模块引用a模块：&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
b <span class="token operator">=</span> <span class="token string">&quot;修改值-b模块内变量&quot;</span>
</code></pre></div><p><a href="https://mp.weixin.qq.com/s/5CYvCdq9s8e0j-0qlm3StA" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="rollup"><a href="#rollup" class="header-anchor">#</a> rollup</h3> <p><a href="https://www.rollupjs.com/" target="_blank" rel="noopener noreferrer">rollupjs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>只解决了import / export 和 tree-shaking</p> <div class="language- extra-class"><pre class="language-text"><code>专注打包js, 多用于vue/react库的打包，不涉及图片，样式等
可把es6代码打包成nodejs代码，浏览器代码
cjs: CommonJS
umd: 浏览器和 Nodejs
iife:   浏览器
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>&quot;dev&quot;: &quot;rollup -w -c scripts/config.js --environment TARGET:web-full-dev --sourcemap&quot;,
-w 监听 -c 使用配置文件
f:/vuecli444/sourceVue/rollup/rollup.md 

vuecli444/sourceVue/myvue2 用了rollup
</code></pre></div><p>对比webpack</p> <div class="language- extra-class"><pre class="language-text"><code>webpack先出现，自己注入代码实现require  module.exports方法
</code></pre></div><p>rollup.config.js</p> <p>需要在package.json中添加<code>type:'module'</code></p> <p>rollup --config</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  input<span class="token operator">:</span><span class="token string">'index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span><span class="token punctuation">{</span>
    file<span class="token operator">:</span><span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    format<span class="token operator">:</span><span class="token string">'iife'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>压缩</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> terser <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-terser'</span>
plugins<span class="token operator">:</span><span class="token punctuation">[</span><span class="token function">terser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>compress<span class="token operator">:</span><span class="token punctuation">{</span>drop_console<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><p>babel 文档有</p> <div class="language- extra-class"><pre class="language-text"><code>import babel from '@rollup/plugin-babel'
npm i -D @babel/core @babel/preset-env
// 可解决await问题，代码
</code></pre></div><p>axios怎么解决？ js-sdk不能依赖外部js 用原生解决</p> <div class="language- extra-class"><pre class="language-text"><code>(!) Missing global variable name
output:{
    globals:{
      axios:'axios'
    }
  },
  
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>(!) Unresolved dependencies
external:['axios'],
</code></pre></div><p>node v12版本偏低了</p> <h4 id="demo1-是核心"><a href="#demo1-是核心" class="header-anchor">#</a> demo1 是核心</h4> <p>package.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.1.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;private&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;rollup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rollup -c&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@rollup/plugin-image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@rollup/plugin-json&quot;</span><span class="token operator">:</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;@rollup/plugin-alias&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/compiler-sfc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.45&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2.76.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup-plugin-commonjs&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^10.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup-plugin-node-resolve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.2.4&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;rollup-plugin-replace&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.2.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup-plugin-scss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup-plugin-vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.1.9&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;rollup-plugin-terser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.0.2&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>demo1 rollup.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// import {terser} from &quot;rollup-plugin-terser&quot;;</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'rollup-plugin-vue'</span>
<span class="token keyword">import</span> commonjs <span class="token keyword">from</span> <span class="token string">&quot;rollup-plugin-commonjs&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> scss <span class="token keyword">from</span> <span class="token string">&quot;rollup-plugin-scss&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> image <span class="token keyword">from</span> <span class="token string">&quot;@rollup/plugin-image&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> nodeResolve <span class="token keyword">from</span> <span class="token string">'rollup-plugin-node-resolve'</span>
<span class="token keyword">import</span> json <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-json'</span>
<span class="token keyword">import</span> alias <span class="token keyword">from</span> <span class="token string">&quot;@rollup/plugin-alias&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> replace <span class="token keyword">from</span> <span class="token string">&quot;rollup-plugin-replace&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>v4<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'uuid'</span>
<span class="token comment">// import md5 from &quot;js-md5&quot;;</span>
<span class="token keyword">const</span> customResolver <span class="token operator">=</span> <span class="token function">nodeResolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.mjs'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">,</span> <span class="token string">'.sass'</span><span class="token punctuation">,</span> <span class="token string">'.scss'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> projectRootDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  input<span class="token operator">:</span><span class="token string">'./src/components/addFans1/index.vue'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span><span class="token punctuation">{</span>
    format<span class="token operator">:</span><span class="token string">'umd'</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span><span class="token string">'./distRollup/addFans1.js'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span><span class="token string">'addFans1'</span><span class="token punctuation">,</span>
    globals<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'uuid'</span><span class="token punctuation">,</span><span class="token string">'js-md5'</span><span class="token punctuation">,</span><span class="token string">'axios'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  plugins<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token comment">// terser(),</span>
    <span class="token function">image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">commonjs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      include<span class="token operator">:</span><span class="token regex">/node_modules/</span><span class="token punctuation">,</span>
      namedExports<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string">'uuid'</span><span class="token operator">:</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">{</span>v4<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment">// 解决import {v4} from 'uuid'</span>
        <span class="token comment">// 'js-md5':Object.keys(md5)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">scss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">nodeResolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>mainFields<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'jsnext'</span><span class="token punctuation">,</span><span class="token string">'preferBuiltins'</span><span class="token punctuation">,</span><span class="token string">'browser'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>exportConditions<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'node'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    extensions<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'.vue'</span><span class="token punctuation">,</span><span class="token string">'.js'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">/*nodeResolve({
      extensions:['.vue','.js'],
      exclude:'**!/node_modules/!**'
    }),*/</span>
    <span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">alias</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      entries<span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>find<span class="token operator">:</span><span class="token string">'@'</span><span class="token punctuation">,</span>replacement<span class="token operator">:</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>projectRootDir<span class="token punctuation">,</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      customResolver
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      include<span class="token operator">:</span><span class="token string">'node_modules/js-md5/src/md5.js'</span><span class="token punctuation">,</span>
      values<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token string">'eval('</span> <span class="token operator">:</span> <span class="token string">'[eval][0]('</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="demo2"><a href="#demo2" class="header-anchor">#</a> demo2</h4> <p>package.json</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rollup&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;module&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rollup -c -w&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rollup -v&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;axios&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.1.3&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@babel/core&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.19.6&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@babel/preset-env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^7.19.4&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@rollup/plugin-babel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.0.2&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@rollup/plugin-json&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@rollup/plugin-node-resolve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^15.0.1&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@rollup/plugin-terser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rollup&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^2.79.1&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>demo2 rollup.config.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// import resolve from '@rollup/plugin-node-resolve'</span>
<span class="token comment">// import rollupJson from '@rollup/plugin-json'</span>
<span class="token keyword">import</span> terser <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-terser'</span>
<span class="token keyword">import</span> babel <span class="token keyword">from</span> <span class="token string">'@rollup/plugin-babel'</span>
<span class="token comment">// const production = !process.env.ROLLUP_WATCH;  // 生产环境判断</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  input<span class="token operator">:</span><span class="token string">'src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span><span class="token punctuation">{</span>
    file<span class="token operator">:</span><span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    format<span class="token operator">:</span><span class="token string">'iife'</span><span class="token punctuation">,</span>
    globals<span class="token operator">:</span><span class="token punctuation">{</span>
      axios<span class="token operator">:</span><span class="token string">'axios'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  external<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'axios'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// plugins:[babel({babelHelpers:'bundled'}),terser({compress:{drop_console:true}})]</span>
  plugins<span class="token operator">:</span><span class="token punctuation">[</span><span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">{</span>babelHelpers<span class="token operator">:</span><span class="token string">'bundled'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token comment">// plugins:[resolve({jsnext:true,preferBuiltins:true,browser:true}),rollupJson()]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="nvm"><a href="#nvm" class="header-anchor">#</a> nvm</h3> <p><a href="https://github.com/coreybutler/nvm-windows/releases" target="_blank" rel="noopener noreferrer">nvm-setup.zip<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>按标准教程，先删除已安装的nodejs v12.22.9</p> <p>安装nvm-setup.zip</p> <p>选择安装nvm目录和nodejs目录 f:\soft\nodejs</p> <div class="language-js extra-class"><pre class="language-js"><code>nvm version <span class="token comment">// 1.1.10</span>
nvm install <span class="token number">12.22</span><span class="token number">.9</span> <span class="token comment">// 安装</span>
nvm list 
nvm use xx <span class="token comment">// 切换</span>
webstorm要指定nodejs目录 f<span class="token operator">:</span>\soft\nodejs\node<span class="token punctuation">.</span>exe  并重启电脑 terminal才生效
nvm install <span class="token number">18.12</span><span class="token number">.0</span>
npm i <span class="token operator">-</span>g yarn <span class="token comment">// yarn也要重新安装</span>
</code></pre></div><h3 id="nodejs版本"><a href="#nodejs版本" class="header-anchor">#</a> nodejs版本</h3> <p><a href="https://nodejs.org/download/release/v13.14.0/" target="_blank" rel="noopener noreferrer">nodejs版本<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language- extra-class"><pre class="language-text"><code>https://nodejs.org/download/release/v13.14.0/
vue-cli可安装vue2/3项目 版本要求 v12.0.0 || v14.0.0 
win7最高支持的nodejs版本是v13.14.0
每年 4 月份发布新的偶数版本；
每年 10 月份发布新的奇数版本。
2022 v18
2021 v16
2020 v14
2019 v12
</code></pre></div><h3 id="nodejs-cache-control"><a href="#nodejs-cache-control" class="header-anchor">#</a> nodejs Cache-Control</h3> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 参考 </span>
 <span class="token comment">// 5. 304 缓存有效期判断, 使用 If-Modified-Since，用 Etag 也可以</span>
  <span class="token keyword">const</span> modified <span class="token operator">=</span> req<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'if-modified-since'</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> expectedModified <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>fStat<span class="token punctuation">.</span>mtime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>modified <span class="token operator">&amp;&amp;</span> modified <span class="token operator">==</span> expectedModified<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">304</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> mimeType<span class="token punctuation">[</span>ext<span class="token punctuation">]</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'max-age=3600'</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Last-Modified'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>expectedModified<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 6. 文件头信息设置</span>
  res<span class="token punctuation">.</span>statusCode <span class="token operator">=</span> <span class="token number">200</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">,</span> mimeType<span class="token punctuation">[</span>ext<span class="token punctuation">]</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'max-age=3600'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Content-Encoding'</span><span class="token punctuation">,</span> <span class="token string">'gzip'</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">'Last-Modified'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>expectedModified<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="npm包"><a href="#npm包" class="header-anchor">#</a> npm包</h3> <p>cli-table  命令行表格</p> <p>terminal-link 文本超链接</p> <p>compare-versions 版本比较</p> <p>chalk 颜色</p> <p>open 打开浏览器</p> <p>nodemon   express/koa监听</p> <h3 id="events事件监听"><a href="#events事件监听" class="header-anchor">#</a> events事件监听</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> EventEmitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'events'</span><span class="token punctuation">)</span>
<span class="token comment">// 声明玩家类，让它继承 EventEmitter</span>
<span class="token keyword">class</span> <span class="token class-name">Player</span> <span class="token keyword">extends</span> <span class="token class-name">EventEmitter</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> player <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Player</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 监听kill/win事件</span>
player<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'kill'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//...})</span>
player<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'win'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//...})    </span>
<span class="token comment">// 触发kill、win事件</span>
player<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'kill'</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
player<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'kill'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span>
player<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'win'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="unil-promisify"><a href="#unil-promisify" class="header-anchor">#</a> unil.promisify</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// nodejs 把回调转成promise</span>
fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./xx.json'</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token function">cb</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>buf</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
	<span class="token comment">// ...            </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> util <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'util'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> readFile <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">promisify</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span>readFile<span class="token punctuation">)</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./xx.json'</span><span class="token punctuation">)</span>
<span class="token comment">// 方式二  fs.readFileSync(xx)  不深入研究区分</span>
</code></pre></div><h3 id="linux配置"><a href="#linux配置" class="header-anchor">#</a> linux配置</h3> <div class="language- extra-class"><pre class="language-text"><code>1. git clone  vuexx.git
2. 安装nodejs  
   下载 $wget https://nodejs.org/dist/v12.22.9/node-v12.22.9-linux-x64.tar.xz 
   解压 tar xf node-v12.22.9-linux-x64.tar.xz
   验证 nodejs 
   cd node-v12.22.9-linux-x64
   ./bin/node -v
   //  输出 v12.22.9

3. 切换到root用户 sudo su
   
5. 安装 yarn
   npm i -g yarn
   验证
   ./bin/yarn -v
   // 输出 v1.22.19

6. 设置软链yarn
   ln -s /xx/node-v12.22.9-linux-x64/bin/npm /usr/bin/
   ln -s /xx/node-v12.22.9-linux-x64/bin/node /usr/bin/
   ln -s /xx/node-v12.22.9-linux-x64/bin/yarn /usr/bin/
   ln -s /xx/vuexx/ /front
7. 进到 vuexx
   更新代码 git pull
   安装/更新依赖 yarn
   npm run build
</code></pre></div><h3 id="nodejs执行打包"><a href="#nodejs执行打包" class="header-anchor">#</a> nodejs执行打包</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> shell <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'shelljs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">3000</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/build'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> project <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>project
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>project<span class="token punctuation">)</span> <span class="token keyword">return</span>
  shell<span class="token punctuation">.</span><span class="token function">cd</span><span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span>
  shell<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'npm run build '</span> <span class="token operator">+</span> project<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    shell<span class="token punctuation">.</span><span class="token function">cp</span><span class="token punctuation">(</span><span class="token string">'-R'</span><span class="token punctuation">,</span> <span class="token string">'dist/'</span> <span class="token operator">+</span> project<span class="token punctuation">,</span> <span class="token string">'../../moli/h5game/vue'</span><span class="token punctuation">)</span>
    shell<span class="token punctuation">.</span><span class="token function">cd</span><span class="token punctuation">(</span><span class="token string">'../../moli/h5game'</span><span class="token punctuation">)</span>
    shell<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'git add .'</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
    shell<span class="token punctuation">.</span><span class="token function">cd</span><span class="token punctuation">(</span><span class="token string">'../../h5game_vue_source/vgame/nodejs'</span><span class="token punctuation">)</span>  <span class="token comment">// 回到nodejs目录</span>
    <span class="token comment">// console.log(shell.pwd().stdout);</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Example app listening on port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


</code></pre></div><h3 id="pnpm-2"><a href="#pnpm-2" class="header-anchor">#</a> pnpm</h3> <div class="language- extra-class"><pre class="language-text"><code>支持 monorepo 多项目管理， 包只安装一次
</code></pre></div><p><a href="https://zhuanlan.zhihu.com/p/352437367" target="_blank" rel="noopener noreferrer">pnpm<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>node v12.13.1 升级到v12.22.7</p> <h3 id="重命名"><a href="#重命名" class="header-anchor">#</a> 重命名</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> oldPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'a.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>oldPath<span class="token punctuation">)</span>
fs<span class="token punctuation">.</span><span class="token function">renameSync</span><span class="token punctuation">(</span>oldPath<span class="token punctuation">,</span> oldPath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\.js$/</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><a href="https://segmentfault.com/a/1190000008530636" target="_blank" rel="noopener noreferrer">node.js简单爬虫<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>nodejs 的 axios 请求任何链接都不会跨域，可以当爬虫用，可以获取到html的源代码</p> <h3 id="package-json-版本号"><a href="#package-json-版本号" class="header-anchor">#</a> package.json 版本号</h3> <div class="language- extra-class"><pre class="language-text"><code>指定版本：比如1.2.2，遵循“大版本.次要版本.小版本”的格式规定，安装时只安装指定版本。
波浪号（tilde）+指定版本：比如~1.2.2，表示安装1.2.x的最新版本（不低于1.2.2），但是不安装1.3.x，也就是说安装时不改变大版本号和次要版本号。
插入号（caret）+指定版本：比如ˆ1.2.2，表示安装1.x.x的最新版本（不低于1.2.2），但是不安装2.x.x，也就是说安装时不改变大版本号。需要注意的是，如果大版本号为0，则插入号的行为与波浪号相同，这是因为此时处于开发阶段，即使是次要版本号变动，也可能带来程序的不兼容。
latest：安装最新版本。
</code></pre></div><h3 id="指定node环境执行"><a href="#指定node环境执行" class="header-anchor">#</a> 指定node环境执行</h3> <div class="language-js extra-class"><pre class="language-js"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
</code></pre></div><h3 id="modules-exports-exports"><a href="#modules-exports-exports" class="header-anchor">#</a> modules.exports  exports</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
* 在 Node 中，每个模块内部都有一个自己的 module 对象
* 该 module 对象中，有一个成员叫：exports 也是一个对象
*
*   var module = {
*     exports:{
*       ...
*     }
*   }
*
*  return module.exports
*
*  exports=module.exports
*  导出多个成员  exports.xxx = xxx  exports.yyy = yyy
*  导出多个成员也可以  module.exports = {}  // 少用。。
*  导出单个成员   module.exports= xxx
*  也可以不管 exports
*  两者不要一起用
*  https://www.cnblogs.com/gyz418/p/9711427.html
*/</span>
</code></pre></div><h3 id="require"><a href="#require" class="header-anchor">#</a> require</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//========= demo1  导出1个或多个 exports</span>
<span class="token comment">// a.js</span>
exports<span class="token punctuation">.</span>test1 <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fn'</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// b.js</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>test1<span class="token punctuation">,</span>fn<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 对象解构</span>
<span class="token comment">//========= demo2  导出1个</span>
<span class="token comment">// a2.js </span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>
<span class="token comment">// module.exports = '666'  // console.log(require('./a2')) // 666 </span>
<span class="token comment">// b2.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a2'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 直接出结果  函数要执行一下</span>
<span class="token comment">// const abc = require('./a2')  // 可随便找个变量接收</span>
<span class="token comment">// abc()</span>
</code></pre></div><h3 id="获取命令行参数"><a href="#获取命令行参数" class="header-anchor">#</a> 获取命令行参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// node a.js 123</span>
<span class="token keyword">const</span> arguments <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'参数'</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 123</span>
</code></pre></div><h3 id="path-resolve"><a href="#path-resolve" class="header-anchor">#</a> path.resolve()</h3> <p>路径拼接 将返回当前工作目录的绝对路径</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'../pcgo/'</span> <span class="token operator">+</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'/api/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 这样就可以了 </span>
</code></pre></div><h3 id="process-cwd-路径问题"><a href="#process-cwd-路径问题" class="header-anchor">#</a> process.cwd() 路径问题</h3> <div class="language-js extra-class"><pre class="language-js"><code>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 方法会返回 Node<span class="token punctuation">.</span>js 进程的当前工作目录<span class="token punctuation">,</span>
即 node src<span class="token operator">/</span>index<span class="token punctuation">.</span>js 和 node index<span class="token punctuation">.</span>js 不同层级的返回结果是不一样的，
可通过 npm link来避开
</code></pre></div><h3 id="process"><a href="#process" class="header-anchor">#</a> process</h3> <div class="language-js extra-class"><pre class="language-js"><code>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 当前文件的根路径 f:/xx/xx</span>
</code></pre></div><h3 id="require传参数"><a href="#require传参数" class="header-anchor">#</a> require传参数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// b.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">,</span><span class="token string">'def'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// a.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 接收传递过来的参数 abc def</span>
  <span class="token keyword">return</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">test</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="promptmoduleapi-给类注入数据"><a href="#promptmoduleapi-给类注入数据" class="header-anchor">#</a> PromptModuleAPI 给类注入数据</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 给类注入数据</span>
<span class="token keyword">class</span> <span class="token class-name">PromptModuleAPI</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">creator</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator <span class="token operator">=</span> creator<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">injectPrompt</span> <span class="token punctuation">(</span><span class="token parameter">prompt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>creator<span class="token punctuation">.</span>injectedPrompts<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token parameter">cli</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>    <span class="token comment">// cli参数是一个类的实例</span>
  cli<span class="token punctuation">.</span><span class="token function">injectPrompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment">// 调的是类的方法，并传参</span>
    name<span class="token operator">:</span> <span class="token string">'kang'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span>
  injectedPrompts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> cli <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PromptModuleAPI</span><span class="token punctuation">(</span>obj3<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'xxxx'</span><span class="token punctuation">,</span> cli<span class="token punctuation">.</span>creator<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fn</span><span class="token punctuation">(</span>cli<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 函数参数是个class 实例，就可以调方法</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'xxxx'</span><span class="token punctuation">,</span> cli<span class="token punctuation">.</span>creator<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="批量导出导入文件"><a href="#批量导出导入文件" class="header-anchor">#</a> 批量导出导入文件</h3> <p>在src/node-export-all</p> <h3 id="writefile"><a href="#writefile" class="header-anchor">#</a> writeFile</h3> <div class="language-js extra-class"><pre class="language-js"><code>fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./a/b/c/d/e.js'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment">// 目录必须先创建，不然报错</span>
</code></pre></div><h2 id="api"><a href="#api" class="header-anchor">#</a> api</h2> <h3 id="chalk-控制台颜色"><a href="#chalk-控制台颜色" class="header-anchor">#</a> chalk 控制台颜色</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'this is red'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="commander-命令行"><a href="#commander-命令行" class="header-anchor">#</a> commander 命令行</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> program <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'commander'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 命令行</span>
<span class="token keyword">const</span> execa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'execa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// version</span>
program<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token string">'0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// option</span>
program<span class="token punctuation">.</span><span class="token function">option</span><span class="token punctuation">(</span><span class="token string">'-t, --test'</span><span class="token punctuation">,</span><span class="token string">'this is a test'</span><span class="token punctuation">,</span><span class="token string">'abc'</span><span class="token punctuation">)</span>
<span class="token comment">// 自定义命令   简写   全称         描述         默认值</span>

program<span class="token punctuation">.</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token string">'mkdir &lt;app-name&gt;'</span><span class="token punctuation">)</span>     <span class="token comment">// node demo/0.js mkdir</span>
  <span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span><span class="token string">'mkdir test'</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">action</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>cmd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 执行命令</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'cmd'</span><span class="token punctuation">,</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span>cmd<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// abc</span>
  <span class="token function">execa</span><span class="token punctuation">(</span><span class="token string">'mkdir'</span><span class="token punctuation">,</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">// 运行命令</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">if</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 如果输入某个命令，执行一些对应的操作</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// node 0.js -t  会输出hello</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>program<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// abc</span>
<span class="token punctuation">}</span>

program<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>  <span class="token comment">// 解析输入的命令</span>
</code></pre></div><h3 id="inquirer-交互命令行"><a href="#inquirer-交互命令行" class="header-anchor">#</a> inquirer 交互命令行</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'inquirer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hi, welcome to inquirer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> question <span class="token operator">=</span> <span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
   type<span class="token operator">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
   name<span class="token operator">:</span> <span class="token string">'sass'</span><span class="token punctuation">,</span>
   message<span class="token operator">:</span> <span class="token string">'install sass?'</span><span class="token punctuation">,</span>
   <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
inquirer<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span>question<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="execa-执行命令"><a href="#execa-执行命令" class="header-anchor">#</a> execa 执行命令</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> execa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'execa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// execa('git', ['init'],{cwd:'f:/mycli/demo'})   // 第三个参数是git生成的目录，不写是在node的执行路径文件夹</span>
<span class="token function">execa</span><span class="token punctuation">(</span><span class="token string">'git'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'init'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'git init'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\s+/</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token punctuation">[</span>command<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\s+/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="progress-进度条"><a href="#progress-进度条" class="header-anchor">#</a> progress 进度条</h3> <div class="language-js extra-class"><pre class="language-js"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
<span class="token keyword">var</span> ProgressBar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'progress'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProgressBar</span><span class="token punctuation">(</span><span class="token string">':bar'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>total<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  bar<span class="token punctuation">.</span><span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>bar<span class="token punctuation">.</span>complete<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'\ncomplete\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="minimist-命令行简单版"><a href="#minimist-命令行简单版" class="header-anchor">#</a> minimist  命令行简单版</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> argv <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'minimist'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// node index.js -a 123 -b 456</span>
<span class="token comment">// {_:[],a:'123',b:'456'}</span>
</code></pre></div><h3 id="get-port-端口"><a href="#get-port-端口" class="header-anchor">#</a> get-port 端口</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> getPort <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;get-port&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//随机搞一个可用的端口</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ==============其他情况</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//默认用3000，如果被占用就搞一个随机的可用端口</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token operator">:</span> <span class="token number">3000</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 端口范围</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">3001</span><span class="token punctuation">,</span> <span class="token number">3002</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token operator">:</span> getPort<span class="token punctuation">.</span><span class="token function">makeRange</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">3100</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="other"><a href="#other" class="header-anchor">#</a> other</h3> <div class="language-js extra-class"><pre class="language-js"><code>shelljs  执行操作系统级的命令
fs<span class="token operator">-</span>extra   fs的增强版
semver 版本处理   <span class="token number">1.2</span><span class="token number">.3</span>
commander  minimist yargs meow 都是命令行
</code></pre></div><p><a href="https://zhuanlan.zhihu.com/p/128990729" target="_blank" rel="noopener noreferrer">参考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="npm发包"><a href="#npm发包" class="header-anchor">#</a> npm发包</h2> <ol><li>查看配置 <code>npm config list</code></li> <li>改register <code>npm config set registry https://registry.npmjs.org/</code></li> <li>注册账号 <code>npm adduser</code> <ul><li>可官网注册</li> <li>账号：gyz418</li> <li>密码：老密码+数字凑到10位，密码要10位</li> <li>注册完要到邮箱验证一下</li></ul></li> <li><code>npm whoami</code> 查看当前npm用户</li> <li>项目 npm init -y
<ul><li>package.json 的name 不能大写，不能跟其他包名重复,可在npmjs.com搜一下有没有重复</li></ul></li> <li>发包  <code>npm publish</code></li> <li>登陆 <code>npm login</code></li> <li>重设淘宝镜像 <code>npm config set registry https://registry.npm.taobao.org</code></li></ol> <h3 id="npm全局地址"><a href="#npm全局地址" class="header-anchor">#</a> npm全局地址</h3> <div class="language- extra-class"><pre class="language-text"><code>C:\Users\123\AppData\Roaming\npm\node_modules
</code></pre></div><h3 id="npm包兼容全局库，默认es-module可用"><a href="#npm包兼容全局库，默认es-module可用" class="header-anchor">#</a> npm包兼容全局库，默认es module可用</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// c.js</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">global<span class="token punctuation">,</span>factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span>  <span class="token comment">// node</span>
    global<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 全局库</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">add</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a<span class="token operator">+</span>b
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span>f</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token operator">-</span>f
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    add<span class="token punctuation">,</span>minus
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>// 全局应用</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>c.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>fn<span class="token punctuation">.</span><span class="token function">minus</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>// node应用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> fn <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>fn<span class="token punctuation">.</span><span class="token function">minus</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>// es module应用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> fn <span class="token keyword">from</span> <span class="token string">'c'</span>  <span class="token comment">// c 是npm发布后的package name</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>fn<span class="token punctuation">.</span><span class="token function">minus</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="shelljs"><a href="#shelljs" class="header-anchor">#</a> shelljs</h3> <p>node复制文件夹</p> <h3 id="mddir"><a href="#mddir" class="header-anchor">#</a> mddir</h3> <p>全局安装后，直接mddir，可在当前目录下生成文件树.md</p> <h3 id="path"><a href="#path" class="header-anchor">#</a> path</h3> <p>path.win32.relative()  // 统一显示window上的  \</p> <p>path.posix.relative()  // 统一显示posix上的 /</p> <p>path.relative() // 默认是当前运行的环境</p> <h3 id="new"><a href="#new" class="header-anchor">#</a> new</h3> <p>nodejs   multiparty  文件上传模块    koa-multer</p> <h3 id="npm包安装不了"><a href="#npm包安装不了" class="header-anchor">#</a> npm包安装不了</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 添加 --ignore-scripts 忽略安装Chromium等</span>
yarn add phantomjs<span class="token operator">-</span>prebuilt@<span class="token number">2.1</span><span class="token number">.14</span> <span class="token operator">--</span>ignore<span class="token operator">-</span>scripts
yarn add puppeteer@<span class="token number">2.1</span><span class="token number">.14</span> <span class="token operator">--</span>ignore<span class="token operator">-</span>scripts
</code></pre></div><h3 id="node-sass"><a href="#node-sass" class="header-anchor">#</a> node-sass</h3> <div class="language- extra-class"><pre class="language-text"><code>安装node-sass
yarn config set sass-binary-site http://npm.taobao.org/mirrors/node-sass

// 20220810
npm cache clean -f  // 清缓存
npm i --unsafe-perm node-sass  // 安装
好像不需要安装 python2 
node-sass@4.14.1

// 备用
npm i node-sass --ignore-scripts
npm rebuild node-sass
npm config set registry https://registry.npm.taobao.org --global
</code></pre></div><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzMjA3MTI2NQ==&amp;mid=2247499271&amp;idx=1&amp;sn=e065fd9a4b3d6d92c5931296e8a030d9&amp;chksm=faba6809cdcde11fa5e951c9a6d914b6ac8cd7e060145a8598938d5982853f31d03fdbd196df&amp;scene=126&amp;sessionid=1600825390&amp;key=0b103020784a9979856152fa8d5c69ff17ef92b4659b6f31d098f1e42d91f8fdd42bd7bc87920b19847082e427123c1c9a0a78e3a02cd36ae867844b5ff531827ae6fe5760661e4781e88570d960e82a088dee2f5f17bd8432405b84ab7b722a9d7febd2be5892afc5a4f9c3678d5a5776d775a004dc126e98d735fc70aece38&amp;ascene=1&amp;uin=MzgxOTk1Nzk1&amp;devicetype=Windows+10+x64&amp;version=62090529&amp;lang=zh_CN&amp;exportkey=A4Hzt8EDYWnwNkIYpy5Jdwg%3D&amp;pass_ticket=oh2AqZFBIb3xGS1oqJIeWNiRipKZoKCZDeS7wshwBjJJ0mt0XHItwt9IGENAqQli&amp;wx_header=0" target="_blank" rel="noopener noreferrer">其他方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="mongodb"><a href="#mongodb" class="header-anchor">#</a> mongodb</h2> <p>必须在根目录创建(D)   D:/data/db  注意是根目录</p> <h2 id="npx"><a href="#npx" class="header-anchor">#</a> npx</h2> <p>npm 从5.2版开始，增加了 npx 命令</p> <p><a href="http://www.ruanyifeng.com/blog/2019/02/npx.html" target="_blank" rel="noopener noreferrer">npx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>npx可以调用项目内部安装的模块（默认要在package.json的script标签里面才能用）、避免全局安装模块</p> <p>npx http-server // 开启本地服务    如果没安装全局，会临时下载，用完自动删除</p> <h2 id="快速服务器"><a href="#快速服务器" class="header-anchor">#</a> 快速服务器</h2> <h3 id="serve"><a href="#serve" class="header-anchor">#</a> serve</h3> <p>serve -s dist // 把dist文件夹放进服务器中</p> <p>serve@13.0.0  支持node 12.22.9</p> <p>serve最新版本14</p> <h3 id="http-server"><a href="#http-server" class="header-anchor">#</a> http-server</h3> <h2 id="eslint"><a href="#eslint" class="header-anchor">#</a> eslint</h2> <p>eslint不认识 window、navigator全局变量
解决：需要修改package.json中eslintConfig配置
&quot;env&quot;: {
&quot;browser&quot;: true // 支持浏览器端全局变量
}</p> <p>node包无穷无尽，真可怕</p> <h2 id="markdown"><a href="#markdown" class="header-anchor">#</a> markdown</h2> <p>把md文件转成html可用  showdown 或 markdown-it</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6f322a7c.js" defer></script><script src="/assets/js/2.5281df64.js" defer></script><script src="/assets/js/8.78f8209a.js" defer></script>
  </body>
</html>
